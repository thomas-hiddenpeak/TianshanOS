# TianShanOS å¼€å‘è¿›åº¦è·Ÿè¸ª

> **é¡¹ç›®**ï¼šTianShanOSï¼ˆå¤©å±±æ“ä½œç³»ç»Ÿï¼‰  
> **ç‰ˆæœ¬**ï¼š0.3.1  
> **æœ€åæ›´æ–°**ï¼š2026å¹´1æœˆ28æ—¥  
> **ä»£ç ç»Ÿè®¡**ï¼š110+ ä¸ª C æºæ–‡ä»¶ï¼Œ80+ ä¸ªå¤´æ–‡ä»¶

---

## ğŸ“Š æ€»ä½“è¿›åº¦

| é˜¶æ®µ | çŠ¶æ€ | è¿›åº¦ | é¢„è®¡å®Œæˆ |
|-----|------|------|---------|
| Phase 0: è§„åˆ’ä¸è®¾è®¡ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 1: åŸºç¡€æ¶æ„ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 2: ç¡¬ä»¶æŠ½è±¡å±‚ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 3: æ ¸å¿ƒæœåŠ¡ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 4: LED ç³»ç»Ÿ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 5: è®¾å¤‡é©±åŠ¨ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 6: ç½‘ç»œä¸å®‰å…¨ | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 7: WebUI | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 8: æ–‡æ¡£ä¸æµ‹è¯• | âœ… å®Œæˆ | 100% | 2026-01-15 |
| Phase 9: ç»Ÿä¸€é…ç½®ç³»ç»Ÿ | âœ… å®Œæˆ | 100% | 2026-01-19 |
| Phase 10: WebUI å¢å¼º & SSH Shell | âœ… å®Œæˆ | 100% | 2026-01-21 |
| Phase 11: OTA å›ºä»¶å‡çº§ | âœ… å®Œæˆ | 100% | 2026-01-22 |
| Phase 12: OTA å¢å¼º & Bugä¿®å¤ | âœ… å®Œæˆ | 100% | 2026-01-23 |
| Phase 13: æ—¥å¿—ç³»ç»Ÿå¢å¼º | âœ… å®Œæˆ | 100% | 2026-01-23 |
| Phase 14: LED æ»¤é•œç³»ç»Ÿä¼˜åŒ– | âœ… å®Œæˆ | 100% | 2026-01-23 |
| Phase 15: WebUI æ—¥å¿—æµä¿®å¤ & å¯¼èˆªæ æ¸…ç† | âœ… å®Œæˆ | 100% | 2026-01-24 |
| Phase 16: DRAM ç¢ç‰‡ä¼˜åŒ– | âœ… å®Œæˆ | 100% | 2026-01-24 |
| Phase 17: è‡ªåŠ¨åŒ–å¼•æ“å®ç° | âœ… å®Œæˆ | 100% | 2026-01-27 |
| Phase 18: HTTPS è¯ä¹¦ç®¡ç† | âœ… å®Œæˆ | 100% | 2026-01-27 |
| Phase 19: ä¸»æœºç®¡ç†å¢å¼º | âœ… å®Œæˆ | 100% | 2026-01-27 |
| Phase 20: å˜é‡ç³»ç»Ÿå®ç° | âœ… å®Œæˆ | 100% | 2026-01-27 |
| Phase 21: åŠ¨ä½œæ¨¡æ¿ç³»ç»Ÿ | âœ… å®Œæˆ | 100% | 2026-01-28 |
| Phase 22: è§„åˆ™å¼•æ“å¢å¼º | âœ… å®Œæˆ | 100% | 2026-01-28 |

---

## ğŸ“‹ Phase 22: è§„åˆ™å¼•æ“å¢å¼º âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ28æ—¥  
**ç›®æ ‡**ï¼šå®Œå–„è§„åˆ™å¼•æ“ï¼Œæ”¯æŒè§„åˆ™æŒä¹…åŒ–ã€ç¼–è¾‘ã€æ‰‹åŠ¨è§¦å‘æ¨¡å¼

### åŠŸèƒ½æ¦‚è¿°

è§„åˆ™å¼•æ“æ˜¯è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œæœ¬é˜¶æ®µå®ç°äº†ï¼š
- **è§„åˆ™ NVS æŒä¹…åŒ–**ï¼šè§„åˆ™ä¿å­˜åˆ° NVSï¼Œé‡å¯åè‡ªåŠ¨æ¢å¤
- **è§„åˆ™ç¼–è¾‘åŠŸèƒ½**ï¼šWebUI æ”¯æŒç¼–è¾‘ç°æœ‰è§„åˆ™
- **æ‰‹åŠ¨è§¦å‘æ¨¡å¼**ï¼šæ”¯æŒåˆ›å»ºæ— æ¡ä»¶è§„åˆ™ï¼Œä»…é€šè¿‡æ‰‹åŠ¨è§¦å‘æ‰§è¡Œ
- **SSH/CLI åŠ¨ä½œæ‰§è¡Œ**ï¼šå®Œæ•´æ”¯æŒ SSH å‘½ä»¤å¼•ç”¨å’Œ CLI å‘½ä»¤åŠ¨ä½œ

### æ ¸å¿ƒä¿®å¤

#### 1. è§„åˆ™æ³¨å†Œæ·±æ‹·è´é—®é¢˜

**é—®é¢˜**ï¼š`ts_rule_register()` ä½¿ç”¨æµ…æ‹·è´å¯¼è‡´æ‚¬ç©ºæŒ‡é’ˆ

**åŸå› **ï¼š
```c
// é”™è¯¯ï¼šæµ…æ‹·è´åªå¤åˆ¶æŒ‡é’ˆï¼Œä¸å¤åˆ¶æ•°æ®
memcpy(&s_rule_ctx.rules[idx], rule, sizeof(ts_auto_rule_t));
```

**ä¿®å¤**ï¼šæ”¹ä¸ºæ·±æ‹·è´
```c
// æ­£ç¡®ï¼šåˆ†åˆ«åˆ†é…å†…å­˜å¹¶å¤åˆ¶æ•°æ®
new_rule->conditions.conditions = heap_caps_calloc(...);
memcpy(new_rule->conditions.conditions, rule->conditions.conditions, ...);
new_rule->actions = heap_caps_calloc(...);
memcpy(new_rule->actions, rule->actions, ...);
```

#### 2. ç©ºæ¡ä»¶è§„åˆ™è‡ªåŠ¨è§¦å‘é—®é¢˜

**é—®é¢˜**ï¼šæ²¡æœ‰æ¡ä»¶çš„è§„åˆ™ä¼šè¢«è‡ªåŠ¨è¯„ä¼°è§¦å‘

**åŸå› **ï¼š
```c
// é”™è¯¯ï¼šç©ºæ¡ä»¶è¿”å› true å¯¼è‡´è‡ªåŠ¨è§¦å‘
if (!group || group->count == 0) {
    return true;
}
```

**ä¿®å¤**ï¼šç©ºæ¡ä»¶è¿”å› false
```c
// æ­£ç¡®ï¼šç©ºæ¡ä»¶ä¸æ»¡è¶³ï¼Œä»…æ”¯æŒæ‰‹åŠ¨è§¦å‘
if (!group || group->count == 0) {
    return false;  // ä»…æ‰‹åŠ¨è§¦å‘çš„è§„åˆ™
}
```

#### 3. åŠ¨ä½œç±»å‹æ‰§è¡Œç¼ºå¤±

**é—®é¢˜**ï¼š`TS_AUTO_ACT_SSH_CMD_REF`ï¼ˆç±»å‹ 7ï¼‰å’Œ `TS_AUTO_ACT_CLI` æœªå®ç°

**ä¿®å¤**ï¼šåœ¨ `ts_action_execute()` ä¸­æ·»åŠ å¤„ç†åˆ†æ”¯
```c
case TS_AUTO_ACT_SSH_CMD_REF:
    ret = execute_ssh_ref_action(action);  // è°ƒç”¨ ts_action_exec_ssh_ref()
    break;

case TS_AUTO_ACT_CLI:
    ret = execute_cli_action(action);      // è°ƒç”¨ ts_action_exec_cli()
    break;
```

### è§„åˆ™æŒä¹…åŒ–è®¾è®¡

**NVS å­˜å‚¨ç»“æ„**ï¼š
```
NVS Namespace: auto_rules
â”œâ”€â”€ count      â†’ è§„åˆ™æ•°é‡ (uint8_t)
â”œâ”€â”€ rule_0     â†’ ç¬¬ä¸€æ¡è§„åˆ™ JSON
â”œâ”€â”€ rule_1     â†’ ç¬¬äºŒæ¡è§„åˆ™ JSON
â””â”€â”€ ...
```

**JSON åºåˆ—åŒ–æ ¼å¼**ï¼š
```json
{
  "id": "rule_power_off",
  "name": "ä½ç”µå‹å…³æœº",
  "enabled": true,
  "cooldown_ms": 60000,
  "conditions": {
    "logic": "and",
    "items": [
      {"variable": "power.voltage", "operator": "lt", "value": 12.6}
    ]
  },
  "actions": [
    {"type": "ssh_cmd_ref", "cmd_id": "agx_shutdown", "delay_ms": 0},
    {"type": "log", "message": "ä½ç”µå‹ä¿æŠ¤è§¦å‘", "level": 2}
  ]
}
```

### API ç«¯ç‚¹

| ç«¯ç‚¹ | è¯´æ˜ | å‚æ•° |
|------|------|------|
| `automation.rules.list` | åˆ—å‡ºæ‰€æœ‰è§„åˆ™ | - |
| `automation.rules.add` | åˆ›å»ºè§„åˆ™ | id, name, conditions, actions |
| `automation.rules.get` | è·å–è§„åˆ™è¯¦æƒ… | id |
| `automation.rules.delete` | åˆ é™¤è§„åˆ™ | id |
| `automation.rules.enable` | å¯ç”¨è§„åˆ™ | id |
| `automation.rules.disable` | ç¦ç”¨è§„åˆ™ | id |
| `automation.rules.trigger` | æ‰‹åŠ¨è§¦å‘è§„åˆ™ | id |

### WebUI å¢å¼º

**è§„åˆ™åˆ—è¡¨æ–°å¢åŠŸèƒ½**ï¼š
- âœï¸ ç¼–è¾‘æŒ‰é’®ï¼šç‚¹å‡»æ‰“å¼€ç¼–è¾‘å¼¹çª—
- â–¶ï¸ è§¦å‘æŒ‰é’®ï¼šæ‰‹åŠ¨æ‰§è¡Œè§„åˆ™

**æ·»åŠ /ç¼–è¾‘è§„åˆ™å¼¹çª—**ï¼š
- æ”¯æŒ"ä»…æ‰‹åŠ¨è§¦å‘"å¤é€‰æ¡†
- å‹¾é€‰åéšè—æ¡ä»¶é…ç½®åŒºåŸŸ
- åŠ¨ä½œæ¨¡æ¿ä¸‹æ‹‰é€‰æ‹©

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ts_rule_engine.c` | NVS æŒä¹…åŒ–ã€æ·±æ‹·è´ã€ç©ºæ¡ä»¶å¤„ç†ã€SSH/CLI åŠ¨ä½œæ‰§è¡Œ |
| `ts_rule_engine.h` | æ·»åŠ  `ts_rules_save()` / `ts_rules_load()` å£°æ˜ |
| `ts_api_automation.c` | æ·»åŠ  `automation.rules.get` API |
| `app.js` | è§„åˆ™ç¼–è¾‘ UIã€æ‰‹åŠ¨è§¦å‘å¤é€‰æ¡†ã€editRule() å‡½æ•° |

### è§„åˆ™æ‰§è¡Œæµç¨‹

```
åˆ›å»ºè§„åˆ™ (WebUI/API)
    â†“
ts_rule_register() â†’ æ·±æ‹·è´åˆ°å†…éƒ¨å­˜å‚¨ â†’ ts_rules_save() ä¿å­˜ NVS
    â†“
è§„åˆ™è¯„ä¼°å¾ªç¯ï¼ˆæ¯ 100msï¼‰:
    â†“
ts_rule_evaluate_all()
    â†“
ts_rule_eval_condition_group()
    â†“ (æ¡ä»¶æ»¡è¶³)
ts_action_execute_array() â†’ æ‰§è¡ŒåŠ¨ä½œåºåˆ—
    â†“
execute_ssh_ref_action() / execute_cli_action() / ...
```

---

## ğŸ“‹ Phase 21: åŠ¨ä½œæ¨¡æ¿ç³»ç»Ÿ âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ28æ—¥  
**ç›®æ ‡**ï¼šå®ç°åŠ¨ä½œæ¨¡æ¿ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒåˆ›å»ºã€æ‰§è¡Œã€æŒä¹…åŒ–å¯å¤ç”¨çš„è‡ªåŠ¨åŒ–åŠ¨ä½œ

### åŠŸèƒ½æ¦‚è¿°

åŠ¨ä½œæ¨¡æ¿æ˜¯è‡ªåŠ¨åŒ–å¼•æ“çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œå…è®¸ç”¨æˆ·ï¼š
- **åˆ›å»ºåŠ¨ä½œæ¨¡æ¿**ï¼šå®šä¹‰å¯å¤ç”¨çš„åŠ¨ä½œé…ç½®
- **æ‰§è¡ŒåŠ¨ä½œ**ï¼šæ‰‹åŠ¨è§¦å‘æˆ–ç”±è§„åˆ™å¼•æ“è‡ªåŠ¨è§¦å‘
- **æŒä¹…åŒ–å­˜å‚¨**ï¼šæ¨¡æ¿ä¿å­˜åˆ° NVSï¼Œé‡å¯åè‡ªåŠ¨æ¢å¤

### æ”¯æŒçš„åŠ¨ä½œç±»å‹

| ç±»å‹ | è¯´æ˜ | é…ç½®å‚æ•° |
|------|------|----------|
| **CLI** | æ‰§è¡Œæœ¬åœ°æ§åˆ¶å°å‘½ä»¤ | command, var_name, timeout_ms |
| **SSH** | æ‰§è¡Œå·²é…ç½®çš„ SSH å‘½ä»¤ | cmd_idï¼ˆå¼•ç”¨ SSH å‘½ä»¤é…ç½®ï¼‰ |
| **LED** | æ§åˆ¶ LED è®¾å¤‡ | device, color, effect, brightness |
| **Log** | è®°å½•æ—¥å¿—æ¶ˆæ¯ | level, message |
| **Set Variable** | è®¾ç½®å˜é‡å€¼ | variable, value |
| **Webhook** | å‘é€ HTTP è¯·æ±‚ | url, method, body_template |

### SSH å‘½ä»¤æ‰§è¡Œæµç¨‹

**è®¾è®¡ç†å¿µ**ï¼šåŠ¨ä½œæ¨¡æ¿å¼•ç”¨å·²é…ç½®çš„ SSH å‘½ä»¤ï¼Œè€Œéé‡å¤é…ç½®

```
SSH ç®¡ç†é¡µé¢é…ç½®å‘½ä»¤ â†’ åŠ¨ä½œæ¨¡æ¿å¼•ç”¨å‘½ä»¤ â†’ æ‰§è¡Œæ—¶æŸ¥æ‰¾å¹¶è¿è¡Œ
      (ä¸»æœº+å‘½ä»¤+å˜é‡)        (cmd_id)          (keystore è®¤è¯)
```

**SSH è®¤è¯æœºåˆ¶**ï¼š
- è‡ªåŠ¨ä» `ts_keystore` åŠ è½½ç§é’¥åˆ°å†…å­˜
- ä½¿ç”¨å†…å­˜è®¤è¯è€Œéæ–‡ä»¶è·¯å¾„
- æ”¯æŒ fallback åˆ°æ–‡ä»¶è®¤è¯

### API ç«¯ç‚¹

| ç«¯ç‚¹ | è¯´æ˜ | å‚æ•° |
|------|------|------|
| `automation.actions.list` | åˆ—å‡ºæ‰€æœ‰åŠ¨ä½œæ¨¡æ¿ | - |
| `automation.actions.add` | åˆ›å»ºåŠ¨ä½œæ¨¡æ¿ | id, name, type, ... |
| `automation.actions.get` | è·å–æ¨¡æ¿è¯¦æƒ… | id |
| `automation.actions.delete` | åˆ é™¤æ¨¡æ¿ | id |
| `automation.actions.execute` | æ‰§è¡Œæ¨¡æ¿ | id |

### NVS æŒä¹…åŒ–

åŠ¨ä½œæ¨¡æ¿è‡ªåŠ¨ä¿å­˜åˆ° NVSï¼ˆ`action_tpl` namespaceï¼‰ï¼š
- **æ·»åŠ æ¨¡æ¿**ï¼šç«‹å³ä¿å­˜
- **åˆ é™¤æ¨¡æ¿**ï¼šç«‹å³æ›´æ–°
- **æ›´æ–°æ¨¡æ¿**ï¼šç«‹å³ä¿å­˜
- **åˆå§‹åŒ–æ—¶**ï¼šè‡ªåŠ¨ä» NVS åŠ è½½

**å­˜å‚¨æ ¼å¼**ï¼š
```
NVS Namespace: action_tpl
â”œâ”€â”€ count     â†’ æ¨¡æ¿æ•°é‡ (uint8_t)
â”œâ”€â”€ tpl_0     â†’ ç¬¬ä¸€ä¸ªæ¨¡æ¿ JSON
â”œâ”€â”€ tpl_1     â†’ ç¬¬äºŒä¸ªæ¨¡æ¿ JSON
â””â”€â”€ ...
```

### WebUI é›†æˆ

**è‡ªåŠ¨åŒ–é¡µé¢æ–°å¢"åŠ¨ä½œæ¨¡æ¿"åŒºåŸŸ**ï¼š
- å¡ç‰‡å¼åŠ¨ä½œç±»å‹é€‰æ‹©
- ç±»å‹ç‰¹å®šçš„é…ç½®è¡¨å•
- SSH å‘½ä»¤ä¸‹æ‹‰é€‰æ‹©ï¼ˆå¼•ç”¨å·²é…ç½®å‘½ä»¤ï¼‰
- LED è®¾å¤‡é…ç½®ï¼ˆæ”¯æŒ touch/board/matrixï¼‰
- å®æ—¶æ‰§è¡Œä¸ç»“æœåé¦ˆ

### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ts_action_manager.c` | æ·»åŠ  NVS æŒä¹…åŒ–åŠŸèƒ½ |
| `ts_action_manager.h` | æ·»åŠ  save/load å‡½æ•°å£°æ˜ |
| `ts_api_automation.c` | æ·»åŠ  actions.get API |
| `app.js` | åŠ¨ä½œæ¨¡æ¿ UIï¼ˆåˆ›å»º/ç¼–è¾‘/æ‰§è¡Œï¼‰ |

### æ ¸å¿ƒä»£ç å˜æ›´

**ts_action_manager.c æ–°å¢åŠŸèƒ½**ï¼š
```c
// NVS æŒä¹…åŒ–
esp_err_t ts_action_templates_save(void);  // ä¿å­˜æ‰€æœ‰æ¨¡æ¿åˆ° NVS
esp_err_t ts_action_templates_load(void);  // ä» NVS åŠ è½½æ¨¡æ¿

// åˆå§‹åŒ–æ—¶è‡ªåŠ¨åŠ è½½
esp_err_t ts_action_manager_init(void) {
    // ... åˆ›å»º mutex/queue/task ...
    ts_action_templates_load();  // ä» NVS æ¢å¤æ¨¡æ¿
}

// æ·»åŠ /åˆ é™¤/æ›´æ–°åè‡ªåŠ¨ä¿å­˜
esp_err_t ts_action_template_add(...) {
    // ... æ·»åŠ æ¨¡æ¿ ...
    ts_action_templates_save();  // æŒä¹…åŒ–
}
```

---

## ğŸ“‹ Phase 20: å˜é‡ç³»ç»Ÿç»Ÿä¸€ âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ27æ—¥  
**ç›®æ ‡**ï¼šç»Ÿä¸€å˜é‡å­˜å‚¨ç³»ç»Ÿï¼ŒåºŸå¼ƒæ—§ `ts_var` ç»„ä»¶ï¼Œä½¿ç”¨ `ts_variable`ï¼ˆä½äº `ts_automation` å†…ï¼‰ä½œä¸ºå”¯ä¸€å˜é‡ç³»ç»Ÿ

### ç³»ç»Ÿæ¦‚è¿°

å˜é‡ç³»ç»Ÿæ˜¯è‡ªåŠ¨åŒ–å¼•æ“çš„æ ¸å¿ƒæ•°æ®å±‚ï¼Œæä¾›ï¼š
- **ç±»å‹å®‰å…¨**ï¼šbool/int/float/string å››ç§ç±»å‹
- **SSH ç»“æœå­˜å‚¨**ï¼šè‡ªåŠ¨ä¿å­˜ 7 ä¸ªæ ‡å‡†å˜é‡ï¼ˆstatus/exit_code/extracted/expect_matched/fail_matched/host/timestampï¼‰
- **çº¿ç¨‹å®‰å…¨**ï¼šFreeRTOS mutex ä¿æŠ¤
- **PSRAM ä¼˜å…ˆ**ï¼šå¤§å®¹é‡å˜é‡å­˜å‚¨ä¼˜å…ˆä½¿ç”¨ PSRAM
- **äº‹ä»¶é€šçŸ¥**ï¼šå˜é‡å˜åŒ–é€šè¿‡äº‹ä»¶æ€»çº¿é€šçŸ¥

> **æ¶æ„å˜æ›´ï¼ˆ2026-01-27ï¼‰**ï¼šåŸ `ts_var` ç»„ä»¶å·²åˆ é™¤ï¼Œç»Ÿä¸€ä½¿ç”¨ `ts_variable`ï¼ˆä½äº `components/ts_automation/`ï¼‰ã€‚

### ç»„ä»¶å®ç°

#### ts_variable ç»Ÿä¸€å˜é‡ç³»ç»Ÿ (`components/ts_automation/`)

**æ–‡ä»¶ç»“æ„**ï¼š
```
components/ts_automation/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ include/
â”‚   â””â”€â”€ ts_variable.h     # ç»Ÿä¸€å˜é‡ API
â””â”€â”€ src/
    â””â”€â”€ ts_variable.c     # å®ç°
```

> **æ³¨æ„**ï¼šåŸ `components/ts_var/` ç›®å½•å·²åˆ é™¤ï¼ˆ2026-01-27ï¼‰ã€‚

**å†…å­˜åˆ†é…**ï¼š
- åŠ¨æ€å˜é‡æ•°é‡ï¼ˆæœ€å¤§ 256 ä¸ªï¼Œå¯é…ç½®ï¼‰
- **ä¼˜å…ˆåˆ†é…åˆ° PSRAM**
- è‡ªåŠ¨ fallback åˆ° DRAMï¼ˆå¦‚ PSRAM ä¸å¯ç”¨ï¼‰

**å˜é‡ç±»å‹**ï¼ˆç±»å‹å®‰å…¨ï¼‰ï¼š
| ç±»å‹ | æšä¸¾å€¼ | è¯´æ˜ |
|------|--------|------|
| å¸ƒå°” | `TS_VAR_TYPE_BOOL` | true/false |
| æ•´æ•° | `TS_VAR_TYPE_INT` | 32 ä½æœ‰ç¬¦å·æ•´æ•° |
| æµ®ç‚¹ | `TS_VAR_TYPE_FLOAT` | å•ç²¾åº¦æµ®ç‚¹ |
| å­—ç¬¦ä¸² | `TS_VAR_TYPE_STRING` | UTF-8 å­—ç¬¦ä¸² |

**å˜é‡æ¥æº**ï¼ˆé€šè¿‡ source_id åˆ†ç»„ï¼‰ï¼š
- SSH å‘½ä»¤ç»“æœæŒ‰ source_id è‡ªåŠ¨åˆ†ç»„
- æ”¯æŒæŒ‰ source_id æ‰¹é‡åˆ é™¤

#### æ ¸å¿ƒ API

```c
#include "ts_variable.h"

// åˆå§‹åŒ–ï¼ˆts_automation æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨è°ƒç”¨ï¼‰
esp_err_t ts_variable_init(void);

// ç±»å‹å®‰å…¨çš„è®¾ç½® API
esp_err_t ts_variable_set_string(const char *name, const char *value, const char *source_id);
esp_err_t ts_variable_set_int(const char *name, int value, const char *source_id);
esp_err_t ts_variable_set_float(const char *name, float value, const char *source_id);
esp_err_t ts_variable_set_bool(const char *name, bool value, const char *source_id);

// ç±»å‹å®‰å…¨çš„è·å– API
esp_err_t ts_variable_get(const char *name, ts_auto_value_t *value);
const char* ts_variable_get_string(const char *name, const char *default_val);
int ts_variable_get_int(const char *name, int default_val);
float ts_variable_get_float(const char *name, float default_val);
bool ts_variable_get_bool(const char *name, bool default_val);

// æ£€æŸ¥å­˜åœ¨æ€§
bool ts_variable_exists(const char *name);

// æšä¸¾å˜é‡
esp_err_t ts_variable_iterate(ts_variable_iterate_fn callback, void *user_data);

// æŒ‰æºåˆ é™¤
esp_err_t ts_variable_delete_by_source(const char *source_id);
```

### SSH å‘½ä»¤ç»“æœå­˜å‚¨

SSH å‘½ä»¤æ‰§è¡Œåï¼ŒWebUI è‡ªåŠ¨å­˜å‚¨ 7 ä¸ªæ ‡å‡†å˜é‡ï¼ˆé€šè¿‡ `source_id` åˆ†ç»„ï¼‰ï¼š

| å˜é‡å | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `<source_id>.status` | STRING | æ‰§è¡ŒçŠ¶æ€ï¼šrunning/completed/cancelled/failed |
| `<source_id>.exit_code` | INT | é€€å‡ºç ï¼ˆ0=æˆåŠŸï¼‰ |
| `<source_id>.extracted` | STRING | æ­£åˆ™æå–çš„å†…å®¹ |
| `<source_id>.expect_matched` | BOOL | æ˜¯å¦åŒ¹é…æˆåŠŸæ¨¡å¼ |
| `<source_id>.fail_matched` | BOOL | æ˜¯å¦åŒ¹é…å¤±è´¥æ¨¡å¼ |
| `<source_id>.host` | STRING | æ‰§è¡Œä¸»æœº |
| `<source_id>.timestamp` | INT | æ‰§è¡Œæ—¶é—´æˆ³ |

**WebUI SSH Exec é›†æˆ**ï¼š

WebSocket æ¶ˆæ¯æ”¯æŒ `var_name` å­—æ®µï¼š
```json
{
  "action": "ssh_exec",
  "host_id": "agx@10.10.99.100",
  "command": "cat /sys/class/thermal/thermal_zone0/temp",
  "var_name": "cpu_temp",
  "expect_pattern": "\\d+",
  "timeout_ms": 30000
}
```

æ‰§è¡Œå®Œæˆåè‡ªåŠ¨åˆ›å»ºï¼š
- `cpu_temp.extracted` = "45000" (STRING)
- `cpu_temp.status` = "completed" (STRING)
- `cpu_temp.exit_code` = 0 (INT)
- `cpu_temp.expect_matched` = true (BOOL)

### API ç«¯ç‚¹

é€šè¿‡ `automation.variables.*` API è®¿é—®å˜é‡ï¼š

| ç«¯ç‚¹ | è¯´æ˜ | å‚æ•° |
|------|------|------|
| `automation.variables.get` | è·å–å˜é‡å€¼ | `name` |
| `automation.variables.set` | è®¾ç½®å˜é‡ | `name`, `value`, `type` |
| `automation.variables.delete` | åˆ é™¤å˜é‡ | `name` |
| `automation.variables.list` | åˆ—å‡ºæ‰€æœ‰å˜é‡ | `prefix` (å¯é€‰) |

> **æ³¨æ„**ï¼šåŸ `var.*` API å·²åºŸå¼ƒï¼ˆ2026-01-27ï¼‰ã€‚

### ä¸è‡ªåŠ¨åŒ–å¼•æ“é›†æˆ

ts_variable æ˜¯è‡ªåŠ¨åŒ–å¼•æ“çš„æ ¸å¿ƒæ•°æ®å±‚ï¼š

#### 1. æ•°æ®æºå˜é‡å­˜å‚¨

```c
// ts_source_manager å°†æ•°æ®æºå€¼æ˜ å°„ä¸ºå˜é‡
ts_variable_set_float("agx.cpu_temp", temp_value, "agx_monitor");
```

#### 2. è§„åˆ™å¼•æ“æ¡ä»¶è¯„ä¼°

```c
// ts_rule_engine ä½¿ç”¨ç±»å‹å®‰å…¨ API è·å–å€¼
float temp = ts_variable_get_float("agx.cpu_temp", 0.0f);
if (temp > 80.0f) {
    // è§¦å‘åŠ¨ä½œ
}
```

### æ¶æ„å˜æ›´è®°å½•ï¼ˆ2026-01-27ï¼‰

#### åˆ é™¤çš„æ–‡ä»¶

| æ–‡ä»¶/ç›®å½• | è¯´æ˜ |
|------|------|
| `components/ts_var/` | æ•´ä¸ªç›®å½•åˆ é™¤ï¼ŒåŠŸèƒ½ç»Ÿä¸€åˆ° ts_variable |
| `components/ts_api/src/ts_api_var.c` | æ—§ var.* API å¤„ç†å™¨åˆ é™¤ |

#### ä¿®æ”¹çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|------|
| `components/ts_webui/CMakeLists.txt` | ç§»é™¤ ts_var ä¾èµ– |
| `components/ts_automation/CMakeLists.txt` | ç§»é™¤ ts_var ä¾èµ– |
| `components/ts_api/CMakeLists.txt` | ç§»é™¤ ts_api_var.c å’Œ ts_var ä¾èµ– |
| `components/ts_api/include/ts_api.h` | ç§»é™¤ ts_api_var_register() å£°æ˜ |
| `components/ts_api/src/ts_api.c` | ç§»é™¤ ts_api_var_register() è°ƒç”¨ |
| `components/ts_webui/src/ts_webui_ws.c` | ä½¿ç”¨ ts_variable.h æ›¿ä»£ ts_var.h |
| `components/ts_automation/src/ts_source_manager.c` | é‡å†™ read_variable_source() ä½¿ç”¨ç»Ÿä¸€ API |

### æ–°å¢/ä¿ç•™æ–‡ä»¶

| æ–‡ä»¶ | æè¿° |
|------|------|
| `components/ts_automation/src/ts_variable.c` | ç»Ÿä¸€å˜é‡ç³»ç»Ÿå®ç° |
| `components/ts_automation/include/ts_variable.h` | ç»Ÿä¸€å˜é‡ API |
| `components/ts_webui/www/pages/automation/variables.html` | å˜é‡ç®¡ç†é¡µé¢ |

### å†…å­˜ä¼˜åŒ–æ•ˆæœ

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å |
|------|--------|--------|
| DRAM .bss | 59,952 bytes | 37,936 bytes |
| PSRAM ä½¿ç”¨ | - | +21,504 bytes |
| èŠ‚çœ DRAM | - | ~22KB |

---

## ğŸ“‹ Phase 19: ä¸»æœºç®¡ç†å¢å¼º âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ27æ—¥  
**ç›®æ ‡**ï¼šå®Œå–„ SSH ä¸»æœºç®¡ç†åŠŸèƒ½ï¼Œè§£å†³å¯†é’¥åˆ é™¤åå·²éƒ¨ç½²ä¸»æœºè®°å½•æ®‹ç•™çš„é—®é¢˜

### é—®é¢˜èƒŒæ™¯

åˆ é™¤ SSH å¯†é’¥åï¼Œå·²éƒ¨ç½²ä¸»æœºè®°å½•ä»ç„¶å­˜åœ¨ï¼Œå¯¼è‡´ï¼š
- æ— æ³•æ’¤é”€å…¬é’¥ï¼ˆå› ä¸ºå¯†é’¥å·²ä¸å­˜åœ¨ï¼‰
- æ— æ³•åˆ é™¤æœ¬åœ°è®°å½•
- æ— æ³•æ›´æ–°æœåŠ¡å™¨æŒ‡çº¹

### è§£å†³æ–¹æ¡ˆ

#### 1. CLI `hosts` å‘½ä»¤å¢å¼º ğŸ”§

**æ–°å¢å·²éƒ¨ç½²ä¸»æœºç®¡ç†**ï¼š
```bash
# åˆ—å‡ºæ‰€æœ‰å·²éƒ¨ç½²ä¸»æœº
hosts --deployed

# ç§»é™¤å·²éƒ¨ç½²ä¸»æœºè®°å½•ï¼ˆä»…åˆ é™¤æœ¬åœ°è®°å½•ï¼‰
hosts --deployed --remove --id agx@10.10.99.100

# æ¸…ç©ºæ‰€æœ‰å·²éƒ¨ç½²ä¸»æœºè®°å½•
hosts --deployed --clear --yes
```

**åŸæœ‰æŒ‡çº¹ç®¡ç†ä¿æŒä¸å˜**ï¼š
```bash
hosts --list           # åˆ—å‡ºå·²çŸ¥ä¸»æœºæŒ‡çº¹
hosts --remove --host <ip>  # ç§»é™¤æŒ‡çº¹
hosts --clear --yes    # æ¸…ç©ºæ‰€æœ‰æŒ‡çº¹
```

#### 2. WebUI å®‰å…¨é¡µé¢å¢å¼º ğŸ–¥ï¸

**å·²éƒ¨ç½²ä¸»æœºè¡¨æ ¼**ï¼š
- æ–°å¢"ç§»é™¤"æŒ‰é’®ï¼ˆä»…åˆ é™¤æœ¬åœ°è®°å½•ï¼Œä¸æ’¤é”€è¿œç¨‹å…¬é’¥ï¼‰
- åŸæœ‰"æ’¤é”€"æŒ‰é’®ä¿æŒï¼ˆæ’¤é”€è¿œç¨‹å…¬é’¥å¹¶åˆ é™¤æœ¬åœ°è®°å½•ï¼‰

**æ–°å¢"å·²çŸ¥ä¸»æœºæŒ‡çº¹"ç®¡ç†åŒºåŸŸ**ï¼š
- æ˜¾ç¤ºæ‰€æœ‰ SSH æœåŠ¡å™¨æŒ‡çº¹
- æ”¯æŒæŸ¥çœ‹å®Œæ•´æŒ‡çº¹
- æ”¯æŒåˆ é™¤æŒ‡çº¹ï¼ˆæœåŠ¡å™¨é‡è£…åéœ€è¦ï¼‰

#### 3. å†…å­˜ä¼˜åŒ– ğŸ’¾

**PSRAM åˆ†é…è¿ç§»**ï¼š
- `ts_api_key.c`: `ts_keystore_key_info_t` æ•°ç»„æ”¹ç”¨ `heap_caps_malloc(SPIRAM)` 
- `ts_cmd_key.c`: åŒä¸Š
- `ts_cmd_hosts.c`: `ts_ssh_host_config_t` æ•°ç»„æ”¹ç”¨ PSRAM

### ä¿®æ”¹æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `ts_cmd_hosts.c` | æ·»åŠ  `--deployed` æ¨¡å¼å’Œç›¸å…³å¤„ç†å‡½æ•° |
| `ts_api_key.c` | ä½¿ç”¨ PSRAM åˆ†é…é¿å…æ ˆæº¢å‡º |
| `ts_cmd_key.c` | ä½¿ç”¨ PSRAM åˆ†é…é¿å…æ ˆæº¢å‡º |
| `app.js` | å®‰å…¨é¡µé¢æ·»åŠ "å·²çŸ¥ä¸»æœºæŒ‡çº¹"åŒºåŸŸå’Œ"ç§»é™¤"æŒ‰é’® |

### å®‰å…¨é¡µé¢æ–°ç»“æ„

```
å®‰å…¨ä¸è¿æ¥
â”œâ”€â”€ ğŸ”‘ å¯†é’¥ç®¡ç†
â”‚   â”œâ”€â”€ SSH å¯†é’¥ï¼ˆts_keystoreï¼‰
â”‚   â””â”€â”€ HTTPS å¯†é’¥ï¼ˆts_certï¼‰
â”œâ”€â”€ ğŸ–¥ï¸ å·²éƒ¨ç½²ä¸»æœº
â”‚   â”œâ”€â”€ æµ‹è¯•è¿æ¥
â”‚   â”œâ”€â”€ æ’¤é”€å…¬é’¥ï¼ˆå¹¶åˆ é™¤è®°å½•ï¼‰
â”‚   â””â”€â”€ ç§»é™¤è®°å½•ï¼ˆä»…æœ¬åœ°ï¼‰ âœ¨ æ–°å¢
â”œâ”€â”€ ğŸ” å·²çŸ¥ä¸»æœºæŒ‡çº¹ âœ¨ æ–°å¢
â”‚   â”œâ”€â”€ æŸ¥çœ‹å®Œæ•´æŒ‡çº¹
â”‚   â””â”€â”€ åˆ é™¤æŒ‡çº¹
â””â”€â”€ ğŸ”’ HTTPS è¯ä¹¦
```

---

## ğŸ“‹ Phase 18: HTTPS è¯ä¹¦ç®¡ç† âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ27æ—¥  
**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„ HTTPS/mTLS è¯ä¹¦ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒè®¾å¤‡ç«¯ PKI æ“ä½œå’Œ WebUI ç®¡ç†ç•Œé¢

### æ ¸å¿ƒåŠŸèƒ½

#### 1. ts_cert è¯ä¹¦ç®¡ç†ç»„ä»¶ ğŸ”

**å®ç°ç‰¹æ€§**ï¼š
- ECDSA P-256 å¯†é’¥å¯¹ç”Ÿæˆï¼ˆå­˜å‚¨åœ¨ PSRAMï¼Œå®‰å…¨æ¸…é›¶ï¼‰
- X.509 CSR ç”Ÿæˆï¼ˆç¬¦åˆ RFC 2986ï¼‰
- è¯ä¹¦é“¾éªŒè¯ï¼ˆRoot CA â†’ Intermediate CA â†’ Device Certï¼‰
- NVS æŒä¹…åŒ–å­˜å‚¨ï¼ˆç§é’¥/è¯ä¹¦/CAé“¾ï¼‰
- è¯ä¹¦çŠ¶æ€æŸ¥è¯¢ï¼ˆæœ‰æ•ˆæœŸã€ä¸»ä½“ã€ç­¾å‘è€…ï¼‰

**å­˜å‚¨æ¶æ„**ï¼š
```
NVS namespace: ts_cert
â”œâ”€â”€ priv_key    - ECDSA P-256 ç§é’¥ (PEM)
â”œâ”€â”€ cert        - è®¾å¤‡è¯ä¹¦ (PEM)
â””â”€â”€ ca_chain    - CA è¯ä¹¦é“¾ (PEM)
```

#### 2. Core API å±‚ (ts_api_cert) ğŸŒ

**7 ä¸ª REST API ç«¯ç‚¹**ï¼š

| API | æ–¹æ³• | åŠŸèƒ½ |
|-----|------|------|
| `cert.status` | GET | è·å–è¯ä¹¦çŠ¶æ€ï¼ˆæœ‰æ•ˆæœŸã€CNã€ç­¾å‘è€…ç­‰ï¼‰ |
| `cert.generate_key` | POST | ç”Ÿæˆæ–°çš„ ECDSA P-256 å¯†é’¥å¯¹ |
| `cert.generate_csr` | POST | ç”Ÿæˆ CSRï¼ˆéœ€æä¾› CNï¼‰ |
| `cert.get_csr` | GET | è·å–å·²ç”Ÿæˆçš„ CSR |
| `cert.install` | POST | å®‰è£…ç­¾å‘çš„è¯ä¹¦ï¼ˆPEM æ ¼å¼ï¼‰ |
| `cert.install_ca` | POST | å®‰è£… CA è¯ä¹¦é“¾ |
| `cert.delete` | POST | åˆ é™¤æ‰€æœ‰è¯ä¹¦å’Œå¯†é’¥ |

**è¿”å›æ ¼å¼ç¤ºä¾‹**ï¼š
```json
{
  "success": true,
  "data": {
    "has_private_key": true,
    "has_certificate": true,
    "has_ca_chain": true,
    "cert_info": {
      "subject_cn": "TIANSHAN-DEVICE-001",
      "issuer_cn": "TianShanOS Intermediate CA",
      "not_before": "2026-01-27 00:00:00",
      "not_after": "2027-01-27 00:00:00",
      "serial": "01",
      "is_valid": true,
      "days_until_expiry": 363
    }
  }
}
```

#### 3. WebUI å®‰å…¨é¡µé¢å¢å¼º ğŸ¨

**ç»Ÿä¸€å¯†é’¥ç®¡ç†è¡¨æ ¼**ï¼š
- SSH å¯†é’¥ï¼ˆæ¥è‡ª ts_keystoreï¼‰
- HTTPS å¯†é’¥ï¼ˆæ¥è‡ª ts_certï¼‰
- çŠ¶æ€å±•ç¤ºï¼šğŸ” å·²ç”Ÿæˆ / ğŸ”’ æœªç”Ÿæˆ
- æ“ä½œæŒ‰é’®ï¼šç”Ÿæˆå¯†é’¥ã€æŸ¥çœ‹è¯ä¹¦ã€ç”Ÿæˆ CSRã€åˆ é™¤

**HTTPS è¯ä¹¦çŠ¶æ€å¡ç‰‡**ï¼š
- è¯ä¹¦æœ‰æ•ˆæ€§æŒ‡ç¤ºï¼ˆâœ… å·²æ¿€æ´» / âš ï¸ å³å°†è¿‡æœŸ / âŒ å·²è¿‡æœŸï¼‰
- è¯¦ç»†ä¿¡æ¯ï¼šä¸»ä½“ CNã€ç­¾å‘è€…ã€æœ‰æ•ˆæœŸã€åºåˆ—å·
- æ“ä½œæŒ‰é’®ï¼šç”Ÿæˆ CSRã€å®‰è£…è¯ä¹¦ã€å®‰è£… CAã€åˆ é™¤

**æ¨¡æ€æ¡†äº¤äº’**ï¼š
- CSR ç”Ÿæˆï¼šè¾“å…¥ CN â†’ è°ƒç”¨ API â†’ æ˜¾ç¤º PEMï¼ˆå¯å¤åˆ¶ï¼‰
- è¯ä¹¦å®‰è£…ï¼šç²˜è´´ PEM â†’ è°ƒç”¨ API â†’ åˆ·æ–°çŠ¶æ€
- CA å®‰è£…ï¼šç²˜è´´ CA é“¾ PEM â†’ è°ƒç”¨ API â†’ éªŒè¯å®Œæ•´æ€§

### æŠ€æœ¯ç»†èŠ‚

#### API ç«¯ç‚¹é™åˆ¶è°ƒæ•´
å°† `CONFIG_TS_API_MAX_ENDPOINTS` ä» 200 å¢åŠ åˆ° 256ï¼Œæ”¯æŒæ–°å¢çš„ 7 ä¸ªè¯ä¹¦ APIã€‚

#### å‰ç«¯å­—æ®µæ˜ å°„ä¿®å¤
ä¿®å¤ API è¿”å›å­—æ®µä¸å‰ç«¯ä»£ç ä¸åŒ¹é…çš„é—®é¢˜ï¼š
- `has_keypair` â†’ `has_private_key`
- `certificate` â†’ `cert_info`

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | æè¿° |
|------|------|
| `components/ts_api/src/ts_api_cert.c` | è¯ä¹¦ API å®ç°ï¼ˆ7 ä¸ªç«¯ç‚¹ï¼‰ |
| `components/ts_webui/web/js/api.js` | æ–°å¢ `CertAPI` å‘½åç©ºé—´ |
| `components/ts_webui/web/js/app.js` | å®‰å…¨é¡µé¢ HTTPS è¯ä¹¦ç®¡ç† UI |

### å®‰å…¨é¡µé¢ç»“æ„

```
å®‰å…¨ä¸è¿æ¥
â”œâ”€â”€ ğŸ”‘ å¯†é’¥ç®¡ç†
â”‚   â”œâ”€â”€ SSH å¯†é’¥ï¼ˆts_keystoreï¼‰
â”‚   â””â”€â”€ HTTPS å¯†é’¥ï¼ˆts_certï¼‰ âœ¨ æ–°å¢
â”œâ”€â”€ ğŸ–¥ï¸ å·²éƒ¨ç½²ä¸»æœº
â””â”€â”€ ğŸ”’ HTTPS è¯ä¹¦ âœ¨ æ–°å¢
    â”œâ”€â”€ çŠ¶æ€å¡ç‰‡ï¼ˆæœ‰æ•ˆæœŸ/CN/ç­¾å‘è€…ï¼‰
    â””â”€â”€ æ“ä½œæŒ‰é’®ï¼ˆCSR/å®‰è£…/åˆ é™¤ï¼‰
```

---

## ğŸ“‹ Phase 17: è‡ªåŠ¨åŒ–å¼•æ“å®ç° âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ25æ—¥ - 1æœˆ27æ—¥  
**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„è‡ªåŠ¨åŒ–å¼•æ“ï¼Œæ”¯æŒå¤šæ•°æ®æºç›‘æ§å’Œ WebUI Dashboard

### æ ¸å¿ƒåŠŸèƒ½

#### 1. æ•°æ®æºç®¡ç†ç³»ç»Ÿ (ts_source_manager) ğŸ”Œ

**æ”¯æŒçš„æ•°æ®æºåè®®**ï¼š
- **Socket.IO**: å®æ—¶ WebSocket æ•°æ®æµï¼ˆå¦‚ AGX tegrastatsï¼‰
- **REST API**: HTTP è½®è¯¢æ•°æ®æºï¼ˆå¦‚ LPMU çŠ¶æ€ï¼‰
- **WebSocket**: åŸç”Ÿ WebSocket è¿æ¥

**é…ç½®ç»Ÿä¸€åŒ–**ï¼š
```json
{
  "sources": [{
    "id": "agx",
    "type": "socketio",
    "url": "http://10.10.99.98:58090",
    "events": ["tegrastats_update"],
    "mappings": [
      {"json_path": "cpu[0].usage", "var_name": "agx.cpu0_usage"},
      {"json_path": "temperature.cpu", "var_name": "agx.cpu_temp"}
    ]
  }]
}
```

**è‡ªåŠ¨å‘ç° (auto_discover)**ï¼š
- Socket.IO / REST æºå‡æ”¯æŒ `auto_discover: true`
- è‡ªåŠ¨ä» JSON å“åº”ä¸­æå–æ‰€æœ‰å­—æ®µåˆ›å»ºå˜é‡
- é¦–æ¬¡æ¥æ”¶æ•°æ®æ—¶è‡ªåŠ¨æ³¨å†Œï¼Œæ”¯æŒåµŒå¥—å¯¹è±¡/æ•°ç»„

#### 2. å˜é‡å­˜å‚¨ç³»ç»Ÿ (ts_variable) ğŸ“Š

**å®ç°ç‰¹æ€§**ï¼š
- æ”¯æŒ bool/int/float/string å››ç§ç±»å‹
- çº¿ç¨‹å®‰å…¨ï¼ˆFreeRTOS mutexï¼‰
- ä¼˜å…ˆä½¿ç”¨ PSRAM åˆ†é…
- å˜é‡å˜åŒ–é€šè¿‡äº‹ä»¶æ€»çº¿é€šçŸ¥
- æ”¯æŒæŒ‰å‰ç¼€æšä¸¾ã€æŒ‰æºæ‰¹é‡åˆ é™¤

#### 3. JSONPath è§£æå™¨ (ts_jsonpath) ğŸ”

**è½»é‡çº§å®ç°**ï¼š
```c
// æ”¯æŒçš„è¯­æ³•
cJSON *val = ts_jsonpath_get(root, "cpu[0].usage");      // æ•°ç»„ç´¢å¼•
cJSON *arr = ts_jsonpath_get(root, "cpu[*].freq");       // é€šé…ç¬¦å±•å¼€
cJSON *last = ts_jsonpath_get(root, "history[-1].value"); // è´Ÿç´¢å¼•
```

**ä¾¿æ· API**ï¼š
```c
double temp = ts_jsonpath_get_number(data, "temperature.cpu", 0.0);
char *name = ts_jsonpath_get_string(data, "device.name");  // è°ƒç”¨æ–¹éœ€ free
```

#### 4. ç®—åŠ›è®¾å¤‡ç›‘æ§ (ts_compute_monitor) ğŸ–¥ï¸

**ç‹¬ç«‹æ¨¡å—**ï¼ˆä» ts_source_manager åˆ†ç¦»ï¼‰ï¼š
- ä¸“é—¨ç›‘æ§ Jetson AGX ç­‰ç®—åŠ›è®¾å¤‡
- Socket.IO åè®®å®Œæ•´å®ç°ï¼ˆæ¡æ‰‹/probe/upgrade/ping-pongï¼‰
- è‡ªåŠ¨é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
- æ¸©åº¦æ•°æ®è‡ªåŠ¨æ¨é€åˆ° `ts_temp_source`

**CLI å‘½ä»¤**ï¼š
```bash
compute --status           # è¿æ¥çŠ¶æ€
compute --data --json      # æœ€æ–°æ•°æ®ï¼ˆJSON æ ¼å¼ï¼‰
compute --start/--stop     # å¯åŠ¨/åœæ­¢ç›‘æ§
compute --config --server 10.10.99.98 --port 58090
```

#### 5. WebUI Dashboard å¢å¼º ğŸ¨

**æ•°æ®æºé…ç½®é¡µé¢** (`/automation/sources`)ï¼š
- æºåˆ—è¡¨å±•ç¤ºï¼ˆçŠ¶æ€ã€åè®®ã€è¿æ¥ä¿¡æ¯ï¼‰
- æ–°å¢/ç¼–è¾‘æºé…ç½®ï¼ˆè¡¨å• + JSON é«˜çº§æ¨¡å¼ï¼‰
- å˜é‡æµè§ˆå™¨ï¼ˆå®æ—¶å€¼ã€ç±»å‹ã€æ›´æ–°æ—¶é—´ï¼‰

**æ¨¡æ€æ¡† CSS ä¿®å¤**ï¼š
- ä¿®å¤ `.modal` é»˜è®¤éšè—é€»è¾‘ä¸ JS çš„ `hidden` ç±»ä¸åŒ¹é…é—®é¢˜
- ç»Ÿä¸€ä½¿ç”¨ `hidden` ç±»æ§åˆ¶æ˜¾ç¤º/éšè—

### æŠ€æœ¯ä¼˜åŒ–

#### æ—¥å¿—çº§åˆ«è°ƒæ•´
å°† `ts_source_manager.c` ä¸­çš„é¢‘ç¹æ“ä½œæ—¥å¿—ä» INFO æ”¹ä¸º DEBUGï¼š
- Socket.IO äº‹ä»¶æ¥æ”¶/åŒ¹é…
- å€¼æ›´æ–°é€šçŸ¥
- åè®®æ¡æ‰‹ç»†èŠ‚ï¼ˆprobe/upgrade/connectï¼‰
- mapping å¤„ç†å’Œ auto-discover ç»“æœ

**æ•ˆæœ**ï¼šCLI å¯æ­£å¸¸äº¤äº’ï¼Œä¸è¢«æ—¥å¿—åˆ·å±

#### sdkconfig.defaults åŒæ­¥
æ–°å¢é…ç½®é¡¹ï¼š
```kconfig
# Automation Engine
CONFIG_TS_AUTOMATION_ENABLED=y
CONFIG_TS_AUTOMATION_CONFIG_PATH="/sdcard/config/automation.json"
CONFIG_TS_AUTOMATION_MAX_SOURCES=16
CONFIG_TS_AUTOMATION_MAX_RULES=32
CONFIG_TS_AUTOMATION_MAX_VARIABLES=256

# HTTPS/mTLS æ§åˆ¶é€šé“
CONFIG_TS_HTTPS_ENABLED=y
CONFIG_TS_HTTPS_REQUIRE_CLIENT_CERT=y

# WebUI
CONFIG_TS_WEBUI_ENABLE=y
CONFIG_TS_WEBUI_WS_ENABLE=y
CONFIG_TS_WEBUI_CORS_ENABLE=y

# LED Matrix
CONFIG_TS_LED_MATRIX_WIDTH=32
CONFIG_TS_LED_MATRIX_HEIGHT=32
```

### æ–°å¢æ–‡ä»¶

| æ–‡ä»¶ | æè¿° |
|------|------|
| `components/ts_automation/src/ts_variable.c` | å˜é‡å­˜å‚¨å®ç° |
| `components/ts_automation/src/ts_source_manager.c` | æ•°æ®æºç®¡ç† |
| `components/ts_jsonpath/` | JSONPath è§£æç»„ä»¶ |
| `components/ts_drivers/src/ts_compute_monitor.c` | ç®—åŠ›è®¾å¤‡ç›‘æ§ |
| `components/ts_console/commands/ts_cmd_compute.c` | compute å‘½ä»¤ |

### ç›¸å…³æ–‡æ¡£

- `docs/AUTOMATION_ENGINE.md` - è‡ªåŠ¨åŒ–å¼•æ“è®¾è®¡æ–‡æ¡£
- `sdkconfig.defaults` - é¡¹ç›®é…ç½®åŒæ­¥æ›´æ–°

---

## ğŸ“‹ Phase 16: DRAM ç¢ç‰‡ä¼˜åŒ– âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ24æ—¥  
**ç›®æ ‡**ï¼šé™ä½ DRAM ç¢ç‰‡ç‡ï¼Œæå‡æœ€å¤§è¿ç»­å—å¤§å°ä»¥æ»¡è¶³ DMA éœ€æ±‚

### ä¼˜åŒ–èƒŒæ™¯

**é—®é¢˜**ï¼šDRAM ç¢ç‰‡ç‡é«˜è¾¾ ~60%ï¼Œæœ€å¤§è¿ç»­å—ä»… ~40KBï¼Œå½±å“ DMA å’Œå¤§ç¼“å†²åŒºåˆ†é…ã€‚

**ç›®æ ‡**ï¼šç¢ç‰‡ç‡é™è‡³ <50%ï¼Œæœ€å¤§è¿ç»­å— >60KBã€‚

### ä¼˜åŒ–è¿‡ç¨‹

#### ç¬¬ä¸€è½®ï¼šPSRAM åŸºç¡€é…ç½®
```
ç¢ç‰‡ç‡: 60% â†’ 51.6%
æœ€å¤§å—: ~40KB â†’ 46KB
```
- `SPIRAM_MALLOC_ALWAYSINTERNAL`: 16384 â†’ 512
- `SPIRAM_TRY_ALLOCATE_WIFI_LWIP`: å¯ç”¨
- `NVS_ALLOCATE_CACHE_IN_SPIRAM`: å¯ç”¨

#### ç¬¬äºŒè½®ï¼šæ¿€è¿›ä¼˜åŒ–
```
ç¢ç‰‡ç‡: 51.6% â†’ 44.5%
æœ€å¤§å—: 46KB â†’ 60KB
```
- `SPIRAM_MALLOC_ALWAYSINTERNAL`: 512 â†’ 256
- `FREERTOS_TIMER_TASK_STACK_DEPTH`: 4096 â†’ 3072
- `ESP_WIFI_CACHE_TX_BUFFER_NUM`: 32 â†’ 16
- ä»»åŠ¡æ ˆä¼˜åŒ–ï¼ˆconsole/led/eventï¼‰

#### ç¬¬ä¸‰è½®ï¼šè¿›ä¸€æ­¥å‹ç¼©
```
ç¢ç‰‡ç‡: 44.5% â†’ 43.2%
æœ€å¤§å—: 60KB â†’ 64KB
```
- `SPIRAM_MALLOC_ALWAYSINTERNAL`: 256 â†’ 128
- WiFi ç®¡ç†å¸§ç¼“å†²åŒºå‡å°‘
- LWIP RECVMBOX ä¼˜åŒ–
- âš ï¸ HTTPD_MAX_REQ_HDR_LEN=512 è¿‡äºæ¿€è¿›ï¼Œå·²å›é€€è‡³ 1024

#### æœ€ç»ˆç»“æœ
```
ç¢ç‰‡ç‡: 43.2% â†’ 42.1%
æœ€å¤§å—: 64KB â†’ 68KB
```

### æœ€ç»ˆé…ç½®ï¼ˆsdkconfig.defaultsï¼‰

```kconfig
# PSRAM æ ¸å¿ƒé…ç½®
CONFIG_SPIRAM_MALLOC_ALWAYSINTERNAL=128    # å…³é”®ï¼šä»… <128B ç”¨ DRAM
CONFIG_SPIRAM_MALLOC_RESERVE_INTERNAL=8192
CONFIG_SPIRAM_TRY_ALLOCATE_WIFI_LWIP=y
CONFIG_SPIRAM_ALLOW_STACK_EXTERNAL_MEMORY=y

# WiFi ç¼“å†²åŒºä¼˜åŒ–
CONFIG_ESP_WIFI_STATIC_RX_BUFFER_NUM=4
CONFIG_ESP_WIFI_DYNAMIC_RX_BUFFER_NUM=16
CONFIG_ESP_WIFI_DYNAMIC_TX_BUFFER_NUM=16
CONFIG_ESP_WIFI_CACHE_TX_BUFFER_NUM=16
CONFIG_ESP_WIFI_MGMT_SBUF_NUM=8

# LWIP ä¼˜åŒ–
CONFIG_LWIP_TCP_SND_BUF_DEFAULT=4096
CONFIG_LWIP_TCP_WND_DEFAULT=4096
CONFIG_LWIP_TCPIP_RECVMBOX_SIZE=8

# ä»»åŠ¡æ ˆä¼˜åŒ–
CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH=3072
CONFIG_ESP_SYSTEM_EVENT_TASK_STACK_SIZE=3584
CONFIG_TS_CONSOLE_TASK_STACK_SIZE=6144
CONFIG_TS_LED_TASK_STACK_SIZE=3072

# å…¶ä»– PSRAM è¿ç§»
CONFIG_NVS_ALLOCATE_CACHE_IN_SPIRAM=y
CONFIG_MBEDTLS_EXTERNAL_MEM_ALLOC=y
```

### ä¼˜åŒ–æ•ˆæœæ€»ç»“

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹å–„ |
|------|--------|--------|------|
| DRAM ç¢ç‰‡ç‡ | ~60% | 42.1% | â†“18% |
| DRAM æœ€å¤§å— | ~40KB | 68KB | â†‘70% |
| DRAM åˆ†é…å—æ•° | ~1000 | 842 | â†“16% |
| PSRAM ç¢ç‰‡ç‡ | ~5% | 2.7% | â†“2.3% |

### é…ç½®å½±å“åˆ†ç±»

**åªå½±å“æ€§èƒ½ï¼ˆå®‰å…¨ï¼‰**ï¼š
- `SPIRAM_MALLOC_ALWAYSINTERNAL` - PSRAM è®¿é—®ç•¥æ…¢ä½†åŠŸèƒ½æ­£å¸¸
- WiFi ç¼“å†²åŒºå‡å°‘ - ååé‡å¯èƒ½é™ä½
- LWIP ç¼“å†²åŒºå‡å°‘ - TCP ä¼ è¾“é€Ÿåº¦é™ä½

**å¯èƒ½å¯¼è‡´åŠŸèƒ½å¤±æ•ˆï¼ˆéœ€æ³¨æ„ï¼‰**ï¼š
- ~~`HTTPD_MAX_REQ_HDR_LEN=512`~~ - å·²å›é€€ï¼ŒHTTP å¤´å¤ªé•¿ä¼šè¢«æ‹’ç»
- `HTTPD_MAX_URI_LEN=256` - URI è¶…é•¿ä¼šå¤±è´¥ï¼ˆä¸€èˆ¬å¤Ÿç”¨ï¼‰

### å…³é”®ç»éªŒ

1. **`SPIRAM_MALLOC_ALWAYSINTERNAL` æ˜¯æœ€æœ‰æ•ˆçš„é…ç½®**
   - é»˜è®¤ 16KB â†’ 128 å­—èŠ‚
   - å°†æ•°ç™¾ä¸ªä¸­ç­‰åˆ†é…ä» DRAM è½¬ç§»åˆ° PSRAM
   - æ€§èƒ½ä»£ä»·å¾ˆå°ï¼ˆPSRAM ä»…æ…¢ 2-3 å€ï¼‰

2. **WiFi/LWIP ç¼“å†²åŒºä¼˜åŒ–æœ‰æ”¶ç›Šä½†æœ‰é™**
   - ä¸»è¦å½±å“ç½‘ç»œååé‡
   - å¯¹åµŒå…¥å¼ç®¡ç†åœºæ™¯å½±å“ä¸å¤§

3. **HTTP æœåŠ¡å™¨ç¼“å†²åŒºä¸å®œè¿‡å°**
   - `HTTPD_MAX_REQ_HDR_LEN` æœ€å°å»ºè®® 1024
   - æµè§ˆå™¨è¯·æ±‚å¤´é€šå¸¸ 500-800 å­—èŠ‚

### ç›¸å…³æ–‡ä»¶

- `sdkconfig.defaults` - æ‰€æœ‰é…ç½®ä¿®æ”¹
- `docs/MEMORY_STATUS.md` - å†…å­˜çŠ¶æ€æŠ¥å‘Š
- `docs/MEMORY_OPTIMIZATION.md` - ä¼˜åŒ–æ–¹æ¡ˆæ–‡æ¡£

---

## ğŸ“‹ Phase 15: WebUI æ—¥å¿—æµä¿®å¤ & å¯¼èˆªæ æ¸…ç† âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ24æ—¥  
**ç›®æ ‡**ï¼šä¿®å¤ WebSocket æ—¥å¿—æµæ ¹æœ¬é—®é¢˜ï¼Œä¼˜åŒ– WebUI ç”¨æˆ·ç•Œé¢

### é—®é¢˜è¯Šæ–­ä¸ä¿®å¤

#### 1. WebSocket æ—¥å¿—æµ Bug ä¿®å¤ ğŸ›
**é—®é¢˜ç—‡çŠ¶**ï¼š
- WebSocket è®¢é˜…æˆåŠŸï¼ˆ`log_subscribe` â†’ `log_subscribed`ï¼‰
- å†å²æ—¥å¿—åŠ è½½æ­£å¸¸ï¼ˆ433 æ¡ï¼‰
- ä½†**æ²¡æœ‰å®æ—¶æ—¥å¿—æ¶ˆæ¯æ¨é€åˆ°å‰ç«¯**

**æ ¹æœ¬åŸå› **ï¼š
```c
// é”™è¯¯ä»£ç ï¼ˆcomponents/ts_webui/src/ts_webui_ws.c:1242ï¼‰
ts_log_add_callback(log_ws_callback, TS_LOG_ERROR, NULL, &s_log_callback_handle);
//                                     ^^^^^^^^^^^
// ä½¿ç”¨ TS_LOG_ERROR å¯¼è‡´åªæ¥æ”¶ ERROR çº§åˆ«çš„æ—¥å¿—
```

**ä¿®å¤æ–¹æ¡ˆ**ï¼š
```c
// æ­£ç¡®ä»£ç 
ts_log_add_callback(log_ws_callback, TS_LOG_VERBOSE, NULL, &s_log_callback_handle);
//                                     ^^^^^^^^^^^^^
// ä½¿ç”¨ TS_LOG_VERBOSE æ¥æ”¶æ‰€æœ‰çº§åˆ«ï¼Œç„¶ååœ¨å›è°ƒä¸­æ ¹æ®å®¢æˆ·ç«¯éœ€æ±‚è¿‡æ»¤
```

**è°ƒè¯•æ—¥å¿—å¢å¼º**ï¼š
- è®¢é˜…å¤„ç†ï¼š`Client %d subscribed to logs (minLevel=%d)`
- æµçŠ¶æ€ç®¡ç†ï¼š`update_log_stream_state: need_streaming=%d, current=%d`
- æµå¯ç”¨/ç¦ç”¨ï¼š`Log streaming enabled (receiving all levels)`
- å›è°ƒè¿‡æ»¤ï¼š`log_ws_callback: No clients received log (level=%d)`

#### 2. WebUI å¯¼èˆªæ æ¸…ç† ğŸ¨
**åˆ é™¤çš„å¯¼èˆªé“¾æ¥**ï¼š
- âŒ `#/logs`ï¼ˆæ—¥å¿—é¡µé¢ï¼‰- åŠŸèƒ½å·²æ•´åˆåˆ°ç»ˆç«¯é¡µé¢æ¨¡æ€æ¡†
- âŒ `#/ota`ï¼ˆOTA é¡µé¢ï¼‰- é™ä½è¯¯æ“ä½œé£é™©

**ä¼˜åŒ–åå¯¼èˆª**ï¼ˆ9ä¸ª â†’ 7ä¸ªé“¾æ¥ï¼‰ï¼š
```
ç³»ç»Ÿ | ç½‘ç»œ | ç›‘æ§ | æ–‡ä»¶ | ç»ˆç«¯ | é…ç½® | å®‰å…¨
```

**å‘åå…¼å®¹**ï¼š
```javascript
// æ—§ä¹¦ç­¾ #/logs è‡ªåŠ¨é‡å®šå‘åˆ°ç»ˆç«¯é¡µé¢å¹¶æ‰“å¼€æ—¥å¿—æ¨¡æ€æ¡†
router.register('/logs', () => {
    window.location.hash = '#/terminal';
    setTimeout(() => showTerminalLogsModal(), 100);
});
```

#### 3. ä»£ç æ¸…ç† ğŸ§¹
**åˆ é™¤ä»£ç **ï¼š
- åˆ é™¤ `loadLogsPage()` å‡½æ•°åŠå…¶æ‰€æœ‰ä¾èµ–ï¼ˆ~580 è¡Œï¼‰
- åˆ é™¤æ—¥å¿—é¡µé¢ HTML æ¨¡æ¿å’Œ CSS æ ·å¼
- åˆ é™¤æ—¥å¿—é¡µé¢ç›¸å…³çš„å·¥å…·å‡½æ•°

**ä¿ç•™åŠŸèƒ½**ï¼š
- ç»ˆç«¯é¡µé¢çš„æ—¥å¿—æ¨¡æ€æ¡†å®Œæ•´ä¿ç•™
- WebSocket æ—¥å¿—æµåŸºç¡€è®¾æ–½ä¿ç•™
- æ—¥å¿—ç›¸å…³ API å’Œåç«¯åŠŸèƒ½å®Œæ•´ä¿ç•™

### æ–‡æ¡£æ›´æ–°

#### æ–°å¢/æ›´æ–°æ–‡æ¡£
1. **TROUBLESHOOTING.md**
   - æ–°å¢ç« èŠ‚ï¼šWebSocket æ—¥å¿—æµä¸å·¥ä½œ - æ—¥å¿—å›è°ƒçº§åˆ«é…ç½®é”™è¯¯
   - è®°å½•å®Œæ•´ debug è¿‡ç¨‹å’Œè§£å†³æ–¹æ¡ˆ
   - æä¾›æœ€ä½³å®è·µå’Œä»£ç ç¤ºä¾‹

2. **WEBUI_CLEANUP_PROPOSAL.md**ï¼ˆæ–°æ–‡æ¡£ï¼‰
   - æ—¥å¿—é¡µé¢åˆ é™¤å¯è¡Œæ€§è¯„ä¼°
   - OTA å¯¼èˆªé“¾æ¥åˆ é™¤æ–¹æ¡ˆ
   - å¯¼èˆªæ ä¼˜åŒ–å»ºè®®
   - å®æ–½ä¼˜å…ˆçº§å’Œå…¼å®¹æ€§è€ƒè™‘

3. **QUICK_START.md**
   - æ–°å¢"WebUI é¡µé¢å¯¼èˆª"ç« èŠ‚
   - æ–°å¢"æ—¥å¿—æŸ¥çœ‹"è¯´æ˜ï¼ˆé€šè¿‡ç»ˆç«¯é¡µé¢ï¼‰
   - æ›´æ–°"å›ºä»¶å‡çº§ (OTA)"è®¿é—®æ–¹å¼

### æŠ€æœ¯æ”¶ç›Š

**ç”¨æˆ·ä½“éªŒ**ï¼š
- âœ… æ›´ç®€æ´çš„å¯¼èˆªæ ï¼ˆ7 ä¸ªæ ¸å¿ƒåŠŸèƒ½ï¼‰
- âœ… æ—¥å¿—æŸ¥çœ‹æ— éœ€é¡µé¢åˆ‡æ¢ï¼ˆæ¨¡æ€æ¡†ï¼‰
- âœ… å®æ—¶æ—¥å¿—æµæ­£å¸¸å·¥ä½œ

**ä»£ç è´¨é‡**ï¼š
- âœ… å‡å°‘é‡å¤ä»£ç ï¼ˆ~580 è¡Œï¼‰
- âœ… ç»Ÿä¸€æ—¥å¿—æŸ¥çœ‹å…¥å£
- âœ… é™ä½ç»´æŠ¤æˆæœ¬

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- âœ… WebSocket è¿æ¥æ•°ä¼˜åŒ–ï¼ˆæ¨¡æ€æ¡†ä¸ç»ˆç«¯å…±äº«è¿æ¥ï¼‰
- âœ… æ—¥å¿—å›è°ƒæ­£ç¡®é…ç½®ï¼Œæ¥æ”¶æ‰€æœ‰çº§åˆ«

### ç›¸å…³æ–‡ä»¶

**ä¿®æ”¹æ–‡ä»¶**ï¼š
- `components/ts_webui/src/ts_webui_ws.c` - æ—¥å¿—å›è°ƒçº§åˆ«ä¿®å¤
- `components/ts_webui/web/index.html` - åˆ é™¤å¯¼èˆªé“¾æ¥
- `components/ts_webui/web/js/app.js` - åˆ é™¤æ—¥å¿—é¡µé¢ä»£ç ï¼Œæ·»åŠ è·¯ç”±é‡å®šå‘
- `docs/TROUBLESHOOTING.md` - æ–°å¢æ—¥å¿—æµé—®é¢˜æ’æŸ¥
- `docs/QUICK_START.md` - æ›´æ–° WebUI ä½¿ç”¨è¯´æ˜

**æ–°å¢æ–‡æ¡£**ï¼š
- `docs/WEBUI_CLEANUP_PROPOSAL.md` - WebUI æ¸…ç†æ–¹æ¡ˆ

---

## ğŸ“‹ Phase 14: LED æ»¤é•œç³»ç»Ÿä¼˜åŒ– âœ…

**æ—¶é—´**ï¼š2026å¹´1æœˆ23æ—¥  
**ç›®æ ‡**ï¼šä¼˜åŒ– LED åå¤„ç†æ»¤é•œç³»ç»Ÿï¼Œå¢å¼ºç”¨æˆ·ä½“éªŒ

### å·²å®ŒæˆåŠŸèƒ½

#### 1. æ»¤é•œå‚æ•°æŒä¹…åŒ– ğŸ¯
- [x] å®ç° `ts_led_effect_config_t` å®Œæ•´å‚æ•°ä¿å­˜
- [x] NVS blob å­˜å‚¨ï¼ˆ368 bytes per deviceï¼‰
- [x] å¯åŠ¨è‡ªåŠ¨åŠ è½½å¹¶åº”ç”¨æ»¤é•œé…ç½®
- [x] è°ƒè¯•æ—¥å¿—å®Œå–„ï¼ˆsave/load è¿½è¸ªï¼‰

**æŠ€æœ¯ç»†èŠ‚**ï¼š
```c
// å…¨å±€é…ç½®å­˜å‚¨
static ts_led_effect_config_t s_current_filter_config[3];  // touch, board, matrix

// NVS å­˜å‚¨é”®
// led.tou.fpm (touch filter params)
// led.brd.fpm (board filter params)
// led.mat.fpm (matrix filter params)
```

#### 2. Scanline æ»¤é•œå¢å¼º ğŸŒŠ
- [x] **ç¦»æ•£æ–¹å‘ â†’ è¿ç»­è§’åº¦**ï¼šæ”¯æŒ 0-360Â° ä»»æ„è§’åº¦æ—‹è½¬
- [x] **æ—‹è½¬çŸ©é˜µç®—æ³•**ï¼šä½¿ç”¨å‘é‡æŠ•å½±è®¡ç®—æ‰«æçº¿ä½ç½®
- [x] **å‚æ•°å¢å¼º**ï¼š
  - `width` (1-16): æ‰«æçº¿å®½åº¦ï¼Œå½±å“å…‰æ™•èŒƒå›´
  - `intensity` (0-255): ä¸­å¿ƒäº®åº¦å¢ç›Šï¼Œä½¿ç”¨äºŒæ¬¡è¡°å‡æ›²çº¿
  - `angle` (0-360Â°): æ—‹è½¬è§’åº¦
- [x] **é»˜è®¤å€¼ä¼˜åŒ–**ï¼šwidth=3, intensity=150

**ç®—æ³•æ”¹è¿›**ï¼š
```c
// æ—§ç®—æ³•ï¼š4ä¸ªç¦»æ•£æ–¹å‘ï¼ˆæ°´å¹³/å‚ç›´/å¯¹è§’çº¿ï¼‰
bool horizontal = (direction == HORIZONTAL);
float coord = horizontal ? x : y;

// æ–°ç®—æ³•ï¼šä»»æ„è§’åº¦æŠ•å½±
float angle_rad = angle * M_PI / 180.0f;
float cos_a = cosf(angle_rad);
float sin_a = sinf(angle_rad);
float perp_dist = dx * cos_a + dy * sin_a;

// å¢å¼ºäº®åº¦å…¬å¼ï¼ˆäºŒæ¬¡è¡°å‡ï¼‰
float boost = 1.0 + (intensity/255.0) * 3.0 * fade * fade;
```

#### 3. Wave æ»¤é•œå¢å¼º ğŸŒ€
- [x] **æ–¹å‘æšä¸¾ â†’ è¿ç»­è§’åº¦**ï¼š0-360Â° æ³¢æµªä¼ æ’­æ–¹å‘
- [x] **å‘é‡æŠ•å½±ç®—æ³•**ï¼šæ²¿ä»»æ„è§’åº¦ä¼ æ’­æ³¢æµª
- [x] **æŒ¯å¹…ä¿®æ­£**ï¼šamplitude èŒƒå›´ 0-255ï¼ˆä¿®å¤ WebUI é”™è¯¯çš„ 1-16pxï¼‰
- [x] **é»˜è®¤å€¼ä¼˜åŒ–**ï¼šamplitude=128

**Bug ä¿®å¤**ï¼š
- âŒ æ—§é—®é¢˜ï¼šWebUI amplitude é»˜è®¤å€¼ä¸º 5ï¼Œæ³¢æµªæ•ˆæœå‡ ä¹ä¸å¯è§
- âœ… ä¿®å¤ï¼šamplitude=128ï¼Œæ•ˆæœæ˜æ˜¾å¯è§

#### 4. Sparkle æ»¤é•œä¼˜åŒ– âœ¨
- [x] **é€Ÿåº¦æ§åˆ¶ä¼˜åŒ–**ï¼šç®€åŒ–æ¦‚ç‡è®¡ç®—ï¼Œçº¿æ€§æ˜ å°„
- [x] **å‚æ•°å½±å“å¢å¼º**ï¼š
  - `speed` (0.1-100): é—ªçƒé¢‘ç‡ï¼Œæ¨è 1-10
  - `density` (0-255): åŒæ—¶é—ªçƒåƒç´ æ•°ï¼Œæ¨è 50-150
  - `decay` (0-255): ä½™æ™–è¡°å‡é€Ÿåº¦ï¼Œæ¨è 100-200
- [x] **é»˜è®¤å€¼ä¼˜åŒ–**ï¼šspeed=5, decay=150

**ç®—æ³•ç®€åŒ–**ï¼š
```c
// æ—§ç®—æ³•ï¼šå¤æ‚çš„å¹³æ–¹æ ¹æ˜ å°„
float speed_factor = sqrtf(speed) * 0.1f;
uint32_t spawn_chance = (uint32_t)(speed_factor * density * 2.56f);

// æ–°ç®—æ³•ï¼šç›´æ¥çº¿æ€§æ˜ å°„ï¼ˆæ›´ç›´è§‚ï¼‰
uint32_t spawn_chance = (uint32_t)(speed * density);
```

### ä¸‰å±‚æ¶æ„å®ç°

| å±‚çº§ | ä¿®æ”¹æ–‡ä»¶ | å…³é”®å˜æ›´ |
|------|---------|---------|
| **Core (ts_led_effect)** | `ts_led_effect.h`, `ts_led_effect.c` | - scanline/wave ç»“æ„ä½“æ”¹ä¸º `float angle`<br>- é‡å†™æ—‹è½¬æŠ•å½±ç®—æ³•<br>- sparkle ç®€åŒ–æ¦‚ç‡è®¡ç®— |
| **API (ts_api_led)** | `ts_api_led.c` | - æ·»åŠ  `angle`, `wavelength`, `amplitude` å‚æ•°æå–<br>- è°ƒæ•´é»˜è®¤å€¼ |
| **CLI (ts_cmd_led)** | `ts_cmd_led.c` | - `--direction` å‚æ•°æ”¯æŒ 0-360 è§’åº¦å€¼<br>- sparkle é€Ÿåº¦æ˜ å°„è°ƒæ•´ |
| **WebUI (app.js)** | `app.js` | - filterConfig å‚æ•°æ›´æ–°<br>- paramLabels èŒƒå›´ä¿®æ­£<br>- å¸®åŠ©æ–‡æœ¬å®Œå–„ |

### å‚æ•°å¯¹æ¯”è¡¨

| æ»¤é•œ | å‚æ•° | æ—§èŒƒå›´ | æ–°èŒƒå›´ | è¯´æ˜ |
|------|------|-------|-------|------|
| **scanline** | direction | 0-3 æšä¸¾ | angle: 0-360Â° | è¿ç»­è§’åº¦æ—‹è½¬ |
| **scanline** | intensity | - | 0-255 | äºŒæ¬¡è¡°å‡æ›²çº¿ |
| **wave** | direction | 0-3 æšä¸¾ | angle: 0-360Â° | ä»»æ„æ–¹å‘ä¼ æ’­ |
| **wave** | amplitude | 1-16 (px) | 0-255 | ä¿®æ­£å•ä½é”™è¯¯ |
| **sparkle** | speed | 50 é»˜è®¤ | 5 é»˜è®¤ | æ›´æ…¢çš„èµ·å§‹é€Ÿåº¦ |
| **sparkle** | decay | 230 é»˜è®¤ | 150 é»˜è®¤ | æ›´æ˜æ˜¾çš„ä½™æ™– |

### æ–‡æ¡£æ›´æ–°

- [x] `docs/COMMANDS.md`ï¼šæ›´æ–° filter å‚æ•°è¯´æ˜å’Œç¤ºä¾‹
- [x] `docs/LED_ARCHITECTURE.md`ï¼šæ›´æ–° Effect å‚æ•°è¯¦è§£
- [x] `docs/DEVELOPMENT_PROGRESS.md`ï¼šæ·»åŠ  Phase 14 è®°å½•

### æµ‹è¯•éªŒè¯

```bash
# Scanline è§’åº¦æµ‹è¯•
led --filter scanline --device matrix --direction 0     # 0Â° æ°´å¹³
led --filter scanline --device matrix --direction 45    # 45Â° æ–œå‘
led --filter scanline --device matrix --direction 90    # 90Â° å‚ç›´

# Wave è§’åº¦æµ‹è¯•
led --filter wave --device matrix --direction 90 --amplitude 200

# Sparkle é€Ÿåº¦æµ‹è¯•
led --filter sparkle --device matrix --speed 1 --density 100 --decay 100   # ææ…¢
led --filter sparkle --device matrix --speed 5 --density 150 --decay 150   # æ¨è
```

### æŠ€æœ¯å€ºåŠ¡

- âœ… æ»¤é•œå‚æ•°æŒä¹…åŒ–ï¼ˆå·²è§£å†³ï¼‰
- âœ… Scanline/Wave æ–¹å‘çµæ´»æ€§ï¼ˆå·²è§£å†³ï¼‰
- âœ… Sparkle é€Ÿåº¦æ§åˆ¶é—®é¢˜ï¼ˆå·²è§£å†³ï¼‰
- âœ… Wave amplitude å‚æ•°é”™è¯¯ï¼ˆå·²è§£å†³ï¼‰

---

## ğŸ“‹ Phase 0: è§„åˆ’ä¸è®¾è®¡ âœ…

### å·²å®Œæˆ
- [x] é—®é¢˜åˆ†ææ–‡æ¡£ (REFACTORING_ANALYSIS.md)
- [x] åŸé¡¹ç›®æè¿°æ–‡æ¡£ (PROJECT_DESCRIPTION.md)
- [x] æ¶æ„è®¾è®¡æ–‡æ¡£ (docs/ARCHITECTURE_DESIGN.md)
- [x] å‘½ä»¤è§„èŒƒæ–‡æ¡£ (docs/COMMAND_SPECIFICATION.md)
- [x] æŠ€æœ¯é€‰å‹ç¡®å®š
- [x] é¡¹ç›®ç›®å½•ç»“æ„åˆ›å»º

### å…³é”®å†³ç­–è®°å½•
| å†³ç­–é¡¹ | å†³ç­–ç»“æœ |
|-------|---------|
| å¹³å°æ”¯æŒ | ESP32S3 + ESP32P4 |
| æŠ½è±¡ç­–ç•¥ | ç¼–è¯‘æ—¶ç¡®å®šèŠ¯ç‰‡ï¼Œè¿è¡Œæ—¶åŠ è½½å¼•è„šé…ç½® |
| å¼•è„šé…ç½® | NVS + å¤–éƒ¨æ–‡ä»¶ + é»˜è®¤å€¼ |
| å‘½ä»¤æ ¼å¼ | å‚æ•°é£æ ¼ï¼ŒåŸºäº esp_console |
| ç»„ä»¶é€šä¿¡ | å¢å¼ºçš„äº‹ä»¶æ€»çº¿ + å‘å¸ƒè®¢é˜… |
| æœåŠ¡ç®¡ç† | é˜¶æ®µåŒ–å¯åŠ¨ + ä¾èµ–å›¾ |
| SSH | SSH-2.0 å®¢æˆ·ç«¯ (mbedtls) |
| å›¾åƒæ ¼å¼ | BMP/PNG/JPG/GIF |
| æ–‡ä»¶ç³»ç»Ÿ | FAT32(SDå¡) + SPIFFS(å†…éƒ¨) |

---

## ğŸ“‹ Phase 1: åŸºç¡€æ¶æ„

### ts_core/ts_config - é…ç½®ç®¡ç†
- [x] åŸºç¡€ API å®ç°
- [x] NVS åç«¯
- [x] æ–‡ä»¶åç«¯
- [x] é…ç½®å˜æ›´é€šçŸ¥
- [x] é…ç½®éªŒè¯
- [ ] å•å…ƒæµ‹è¯•

### ts_core/ts_log - æ—¥å¿—ç³»ç»Ÿ
- [x] æ—¥å¿—çº§åˆ«ç®¡ç†
- [x] å¤šè¾“å‡ºç›®æ ‡ï¼ˆä¸²å£ã€æ–‡ä»¶ã€å†…å­˜ï¼‰
- [x] æ—¥å¿—æ ¼å¼åŒ–
- [ ] å•å…ƒæµ‹è¯•

### ts_core/ts_event - äº‹ä»¶ç³»ç»Ÿ
- [x] äº‹ä»¶æ€»çº¿å®ç°
- [x] å‘å¸ƒ/è®¢é˜…æœºåˆ¶
- [x] å¼‚æ­¥äº‹ä»¶å¤„ç†
- [x] äº‹ä»¶ä¼˜å…ˆçº§
- [x] äº‹åŠ¡æ”¯æŒ
- [ ] å•å…ƒæµ‹è¯•

### ts_core/ts_service - æœåŠ¡ç®¡ç†
- [x] æœåŠ¡æ³¨å†Œæœºåˆ¶
- [x] ä¾èµ–ç®¡ç†å™¨
- [x] ç”Ÿå‘½å‘¨æœŸç®¡ç†
- [x] å¥åº·æ£€æŸ¥
- [x] é˜¶æ®µåŒ–å¯åŠ¨
- [ ] å•å…ƒæµ‹è¯•

---

## ğŸ“‹ Phase 2: ç¡¬ä»¶æŠ½è±¡å±‚ âœ…

### ts_hal - ç¡¬ä»¶æŠ½è±¡
- [x] å¼•è„šç®¡ç†å™¨ (ts_pin_manager) - JSONé…ç½®åŠ è½½ã€NVSæŒä¹…åŒ–ã€å†²çªæ£€æµ‹
- [x] GPIO æŠ½è±¡ (ts_hal_gpio) - æ–¹å‘/ä¸Šä¸‹æ‹‰/ä¸­æ–­é…ç½®ã€ISRæ”¯æŒ
- [x] PWM æŠ½è±¡ (ts_hal_pwm) - LEDCé©±åŠ¨ã€å®šæ—¶å™¨è‡ªåŠ¨åˆ†é…ã€æ¸å˜æ”¯æŒ
- [x] SPI æŠ½è±¡ (ts_hal_spi) - æ€»çº¿/è®¾å¤‡åˆ†ç¦»ã€DMAæ”¯æŒ
- [x] I2C æŠ½è±¡ (ts_hal_i2c) - æ–°ç‰ˆi2c_master APIã€è®¾å¤‡æ‰«æ
- [x] UART æŠ½è±¡ (ts_hal_uart) - äº‹ä»¶é˜Ÿåˆ—ã€å›è°ƒæ”¯æŒã€è¡Œè¯»å–
- [x] ADC æŠ½è±¡ (ts_hal_adc) - oneshotæ¨¡å¼ã€æ ¡å‡†æ”¯æŒ
- [x] ESP32S3 å¹³å°é€‚é… (ts_platform_s3)
- [x] ESP32P4 å¹³å°é€‚é…å ä½ (ts_platform_p4)
- [ ] å•å…ƒæµ‹è¯•

### æ¿çº§é…ç½®
- [x] rm01_esp32s3 é…ç½®æ–‡ä»¶
  - board.json - æ¿çº§ç‰¹æ€§é…ç½®
  - pins.json - å¼•è„šæ˜ å°„å®šä¹‰
  - services.json - æœåŠ¡é…ç½®
- [ ] rm01_esp32p4 é…ç½®æ–‡ä»¶ï¼ˆé¢„ç•™ï¼‰

---

## ğŸ“‹ Phase 3: æ ¸å¿ƒæœåŠ¡ âœ…

### ts_console - æ§åˆ¶å°
- [x] åŸºäº esp_console å®ç°
- [x] å‚æ•°è§£æå™¨ (argtable3)
- [x] å‘½ä»¤åˆ†ç±»ç®¡ç†
- [x] å¸®åŠ©ç³»ç»Ÿ
- [x] å†…ç½®å‘½ä»¤ (help, version, sysinfo, tasks, free, reboot, clear, echo, log, lang)
- [x] å†å²è®°å½•ç®¡ç†
- [x] å½©è‰²è¾“å‡ºæ”¯æŒ
- [x] å¤šè¯­è¨€æ”¯æŒ (ts_i18n - è‹±æ–‡/ç®€ä¸­/ç¹ä¸­/æ—¥æ–‡/éŸ©æ–‡)
- [x] è„šæœ¬å¼•æ“ (å˜é‡/æ¡ä»¶/å‘½ä»¤æ‰§è¡Œ, run/eval å‘½ä»¤)
- [ ] å•å…ƒæµ‹è¯•

### ts_api - Core API
- [x] API æ¡†æ¶
- [x] ç«¯ç‚¹æ³¨å†Œ/è°ƒç”¨æœºåˆ¶
- [x] æƒé™æ ‡è®°
- [x] ç»“æœæ ¼å¼åŒ– (JSON)
- [x] ç³»ç»Ÿ API (system.info, system.memory, system.tasks, system.reboot, system.log.level)
- [x] é…ç½® API (config.get, config.set, config.delete, config.list, config.save)
- [x] è®¾å¤‡ API (device.info, device.set, device.fan, device.power)
- [x] LED API (led.list, led.info, led.brightness, led.clear, led.fill, led.effect)
- [x] ç½‘ç»œ API (net.status, net.wifi.scan, net.wifi.connect, net.info)
- [ ] å•å…ƒæµ‹è¯•

### ts_storage - å­˜å‚¨ç®¡ç†
- [x] SPIFFS æ”¯æŒ (æŒ‚è½½/å¸è½½/æ ¼å¼åŒ–/ç»Ÿè®¡)
- [x] SD å¡é©±åŠ¨ (SPI/SDIO 1-bit/4-bit)
- [x] FAT32 æ–‡ä»¶ç³»ç»Ÿ
- [x] æ–‡ä»¶æ“ä½œ API (è¯»/å†™/åˆ é™¤/å¤åˆ¶/é‡å‘½å)
- [x] ç›®å½•æ“ä½œ API (åˆ›å»º/åˆ é™¤/éå†)
- [ ] å•å…ƒæµ‹è¯•

---

## ğŸ“‹ Phase 4: LED ç³»ç»Ÿ âœ…

### ts_led - LED æ§åˆ¶
- [x] WS2812 é©±åŠ¨ (RMT/led_strip)
- [x] æ¸²æŸ“å™¨ (FreeRTOS ä»»åŠ¡, 60Hz)
- [x] å›¾å±‚ç®¡ç†å™¨ (å¤šå›¾å±‚, æ··åˆæ¨¡å¼, é€æ˜åº¦)
- [x] åŠ¨ç”»å¼•æ“ (æ•ˆæœå¸§å›è°ƒ)
- [x] ç‰¹æ•ˆåº“ (rainbow, breathing, chase, sparkle, fire, solid)
- [x] é¢œè‰²å·¥å…· (HSV/RGBè½¬æ¢, è°ƒè‰²ç›˜, é¢œè‰²è§£æ)
- [x] å›¾åƒè§£ç ï¼ˆBMP - 24ä½ï¼‰
- [x] å›¾åƒè§£ç ï¼ˆPNGï¼‰- libpng
- [x] å›¾åƒè§£ç ï¼ˆJPGï¼‰- esp_jpeg
- [x] å›¾åƒè§£ç ï¼ˆGIFï¼‰- ç®€åŒ–è§£ç 
- [x] è®¾å¤‡å®ä¾‹ï¼ˆtouch/board/matrix é¢„è®¾ï¼‰
- [x] çŠ¶æ€æŒ‡ç¤ºç»‘å®š
- [x] LED å‘½ä»¤ (led, led_brightness, led_clear, led_fill, led_effect, led_color)
- [x] å­—ä½“åŠ è½½å™¨ (ts_led_font) - SDå¡åŠ¨æ€åŠ è½½, LRUç¼“å­˜, äºŒåˆ†æŸ¥æ‰¾
- [x] æ–‡æœ¬æ¸²æŸ“å™¨ (ts_led_text) - UTF-8è§£æ, å¯¹é½, æ»šåŠ¨, è¦†ç›–å±‚
- [x] æ–‡æœ¬è¦†ç›–å±‚ç³»ç»Ÿ - ç‹¬ç«‹Layeræ¸²æŸ“, åè‰²å åŠ , å¾ªç¯æ»šåŠ¨

---

## ğŸ“‹ Phase 5: è®¾å¤‡é©±åŠ¨ âœ…

### ts_drivers/fan - é£æ‰‡æ§åˆ¶
- [x] é£æ‰‡é©±åŠ¨ (PWM, 4è·¯)
- [x] æ¸©åº¦æ›²çº¿ (è‡ªåŠ¨æ¨¡å¼)
- [x] è½¬é€Ÿæµ‹é‡ (Tachä¸­æ–­)
- [x] ç´§æ€¥å…¨é€Ÿæ¨¡å¼

### ts_drivers/power - ç”µæºç›‘æ§
- [x] ADC ç”µå‹ç›‘æµ‹
- [x] ç”µå‹è­¦æŠ¥ (é«˜ä½é˜ˆå€¼)
- [x] INA226 I2CèŠ¯ç‰‡æ”¯æŒ
- [x] INA3221 I2CèŠ¯ç‰‡æ”¯æŒ (3é€šé“)
- [x] UART ç”µæºèŠ¯ç‰‡ (PZEM-004T Modbus RTU åè®®)

### ts_drivers/device - è®¾å¤‡æ§åˆ¶
- [x] AGX ç”µæºæ§åˆ¶ (å¼€/å…³/å¤ä½/å¼ºåˆ¶å…³æœº)
- [x] ç”µæºçŠ¶æ€æ£€æµ‹ (power_good)
- [x] å…³æœºè¯·æ±‚å¤„ç† (ä¸­æ–­)
- [x] å¯åŠ¨æ¬¡æ•°ç»Ÿè®¡

### ts_drivers/usb_mux - USB MUX
- [x] MUX åˆ‡æ¢æ§åˆ¶ (Host/Device)
- [x] OE ä½¿èƒ½æ§åˆ¶
- [x] çŠ¶æ€æŸ¥è¯¢

---

## ğŸ“‹ Phase 6: ç½‘ç»œä¸å®‰å…¨ âœ…

### ts_net - ç½‘ç»œ
- [x] ç½‘ç»œå­ç³»ç»Ÿæ¡†æ¶ (esp_netif)
- [x] ä»¥å¤ªç½‘é©±åŠ¨ï¼ˆW5500 SPIï¼‰
- [x] WiFi ç®¡ç†å™¨ (STA/AP/APSTAæ¨¡å¼)
- [x] WiFi æ‰«æ
- [x] DHCP æœåŠ¡å™¨ (lwIPé›†æˆ)
- [x] HTTP æœåŠ¡å™¨ (esp_http_server)
- [x] è·¯ç”±æ³¨å†Œ/å¤„ç†
- [x] é™æ€æ–‡ä»¶æœåŠ¡
- [x] WebSocket (ts_webui_ws)
- [x] HTTPS/mTLS (ts_https_server - TLS 1.2/1.3, è‡ªç­¾åè¯ä¹¦, mTLSå®¢æˆ·ç«¯éªŒè¯)

### ts_security - å®‰å…¨
- [x] éšæœºæ•°ç”Ÿæˆ (esp_random)
- [x] å¯†é’¥ç”Ÿæˆ/å­˜å‚¨/åŠ è½½ (NVS)
- [x] è¯ä¹¦å­˜å‚¨
- [x] ä¼šè¯ç®¡ç† (8è·¯å¹¶å‘)
- [x] æƒé™æ£€æŸ¥ (5çº§æƒé™)
- [x] Tokenç”Ÿæˆ/éªŒè¯
- [x] å¯†ç éªŒè¯
- [x] SHA256/SHA384/SHA512 å“ˆå¸Œ
- [x] HMAC
- [x] AES-GCM åŠ è§£å¯†
- [x] Base64/Hex ç¼–è§£ç 
- [x] RSA/EC å¯†é’¥å¯¹ (RSA-2048/4096, EC-P256/P384, PEMå¯¼å…¥å¯¼å‡º, ç­¾åéªŒè¯)
- [x] SSH å®¢æˆ·ç«¯ (ts_ssh_client - SSH-2.0åè®®, å¯†ç /å…¬é’¥è®¤è¯, è¿œç¨‹å‘½ä»¤æ‰§è¡Œ)
- [x] SSH Known Hosts (ts_ssh_known_hosts - ä¸»æœºå¯†é’¥éªŒè¯, SHA256æŒ‡çº¹, TOFUç­–ç•¥, NVSå­˜å‚¨)
- [x] SSH ç«¯å£è½¬å‘ (ts_port_forward - æœ¬åœ°è½¬å‘, å¤šå¹¶å‘è¿æ¥, libssh2éš§é“)
- [x] SSH äº¤äº’å¼ Shell (ts_ssh_shell - PTYåˆ†é…, å¤šç»ˆç«¯ç±»å‹, åŒå‘I/O, ä¿¡å·å¤„ç†)
- [x] SSH å¯†é’¥ç”Ÿæˆ (CLI --keygen - RSA/ECDSAç”Ÿæˆ, PEMç§é’¥å¯¼å‡º, OpenSSHå…¬é’¥æ ¼å¼)
- [x] SSH å…¬é’¥éƒ¨ç½² (CLI --copyid - è‡ªåŠ¨éƒ¨ç½²å…¬é’¥åˆ°è¿œç¨‹æœåŠ¡å™¨, æƒé™è®¾ç½®, éªŒè¯)
- [x] SSH å®‰å…¨å¯†é’¥å­˜å‚¨ (ts_keystore - NVSåŠ å¯†å­˜å‚¨ç§é’¥, æ”¯æŒå¯¼å…¥/ç”Ÿæˆ/åˆ é™¤/åˆ—è¡¨)
- [x] SSH ä½¿ç”¨å®‰å…¨å­˜å‚¨å¯†é’¥ (--keyid é€‰é¡¹ä»å®‰å…¨å­˜å‚¨åŠ è½½å¯†é’¥è¿›è¡Œè®¤è¯)
- [x] å®‰å…¨åŠ å›º L1 (ç§é’¥å†…å­˜æ¸…é›¶, ç¦æ­¢ç§é’¥å¯¼å‡º, exportableæ ‡è®°, NVS 48KBæ‰©å®¹)
- [x] SSH ä¸»æœºå¯†é’¥éªŒè¯ (TOFUç­–ç•¥, æŒ‡çº¹å˜åŒ–è­¦å‘Š, NVSå­˜å‚¨)
- [x] SSH å…¬é’¥æ’¤é”€ (ssh --revoke ä»è¿œç¨‹åˆ é™¤å·²éƒ¨ç½²å…¬é’¥)
- [x] Known Hosts ç®¡ç† (hostså‘½ä»¤ - list/info/remove/clear)
- [x] SFTP æ–‡ä»¶ä¼ è¾“ (ts_sftp - ls/get/put/rm/mkdir/stat)
- [ ] å®‰å…¨åŠ å›º L2 (NVS åŠ å¯†) - é…ç½®å·²å°±ç»ªï¼Œå¾…åŠŸèƒ½å¼€å‘å®Œæˆåæµ‹è¯•
- [ ] å®‰å…¨åŠ å›º L3/L4 (Secure Boot, Flash åŠ å¯†) - ç”Ÿäº§é˜¶æ®µ

---

## ğŸ“‹ Phase 7: WebUI âœ…

### ts_webui - Web ç•Œé¢
- [x] HTTP æœåŠ¡å™¨é›†æˆ
- [x] REST API ç«¯ç‚¹ (é€šç”¨APIç½‘å…³)
- [x] ç™»å½•/ç™»å‡º API
- [x] Token è®¤è¯
- [x] WebSocket æ”¯æŒ (å¹¿æ’­/äº‹ä»¶)
- [x] é™æ€æ–‡ä»¶æœåŠ¡
- [x] SPA è·¯ç”±æ”¯æŒ
- [x] CORS é…ç½®
- [x] å‰ç«¯ç•Œé¢
  - index.html ä»ªè¡¨ç›˜
  - CSS æ ·å¼æ¡†æ¶
  - API å®¢æˆ·ç«¯åº“
  - WebSocket å®¢æˆ·ç«¯
  - ç™»å½•æ¨¡æ€æ¡†
- [x] WebUI æœåŠ¡é›†æˆ (ts_services.c)
- [x] SPA è·¯ç”±ç³»ç»Ÿ (router.js)
- [x] Web ç»ˆç«¯ (terminal.js + xterm.js)
- [x] SSH Shell WebSocket æ”¯æŒ (ts_webui_ws.c)
- [x] ç”µå‹ä¿æŠ¤äº‹ä»¶ WebSocket å¹¿æ’­
- [x] å®Œæ•´çš„ 7 ä¸ªé¡µé¢ï¼š
  - **ç³»ç»Ÿ**ï¼ˆé¦–é¡µï¼Œåˆå¹¶åŸä»ªè¡¨ç›˜+ç³»ç»Ÿï¼šç³»ç»Ÿä¿¡æ¯/æ—¶é—´/å†…å­˜/ç½‘ç»œ/ç”µæº/é£æ‰‡æ§åˆ¶/æœåŠ¡åˆ—è¡¨/é‡å¯ï¼‰
  - LED æ§åˆ¶ï¼ˆè®¾å¤‡/äº®åº¦/é¢œè‰²/ç‰¹æ•ˆ/å›¾åƒï¼‰
  - ç½‘ç»œé…ç½®ï¼ˆä»¥å¤ªç½‘/WiFi/DHCP/NATï¼‰
  - **è®¾å¤‡æ§åˆ¶**ï¼ˆAGX/LPMU ç”µæºæ§åˆ¶ï¼‰
  - ç»ˆç«¯ï¼ˆWeb CLI + SSH Shellï¼‰
  - å®‰å…¨ï¼ˆSSH æµ‹è¯•ã€å¯†é’¥ç®¡ç†ã€å·²çŸ¥ä¸»æœºï¼‰
  - é…ç½®ï¼ˆé…ç½®åˆ—è¡¨/ç¼–è¾‘/åˆ é™¤ï¼‰
  - æ–‡ä»¶ç®¡ç†ï¼ˆSDå¡/SPIFFS æµè§ˆã€ä¸Šä¼ /ä¸‹è½½ã€æ–°å»º/åˆ é™¤/é‡å‘½åã€**æŒ‚è½½/å¸è½½ SD å¡**ï¼‰

---

## ğŸ“‹ Phase 8: æ–‡æ¡£ä¸æµ‹è¯• âœ…

- [x] å¿«é€Ÿå…¥é—¨æŒ‡å— (docs/QUICK_START.md)
- [x] API å‚è€ƒæ–‡æ¡£ (docs/API_REFERENCE.md)
- [x] æ¿çº§é…ç½®æŒ‡å— (docs/BOARD_CONFIGURATION.md)
- [x] æµ‹è¯•è®¡åˆ’æ–‡æ¡£ (docs/TEST_PLAN.md)
- [ ] é›†æˆæµ‹è¯•ç”¨ä¾‹ - åç»­ç‰ˆæœ¬
- [ ] æ€§èƒ½æµ‹è¯• - åç»­ç‰ˆæœ¬
- [ ] ç¨³å®šæ€§æµ‹è¯• - åç»­ç‰ˆæœ¬

---

## ğŸ“‹ Phase 9: ç»Ÿä¸€é…ç½®ç³»ç»Ÿ âœ…

### ts_config_module - æ¨¡å—åŒ–é…ç½®ç®¡ç†
- [x] æ¨¡å—æšä¸¾å®šä¹‰ (NET/DHCP/WIFI/LED/FAN/DEVICE/SYSTEM)
- [x] Schema å®šä¹‰ç»“æ„ (ç±»å‹ã€é»˜è®¤å€¼ã€æè¿°)
- [x] æ¨¡å—æ³¨å†Œæœºåˆ¶ (ts_config_module_register)
- [x] SDå¡ä¼˜å…ˆåŠ è½½é€»è¾‘ (ts_config_module_load)
- [x] NVS JSON blob å­˜å‚¨ (è§£å†³ 15 å­—ç¬¦é”®åé™åˆ¶)
- [x] åŒå†™åŒæ­¥ (NVS + SDå¡)
- [x] pending_sync çƒ­æ’æ‹”å¤„ç†
- [x] é…ç½®å¯¼å…¥/å¯¼å‡º (ts_config_module_export_to_sdcard)
- [x] é…ç½®é‡ç½® (ts_config_module_reset)

### ts_config_meta - å…ƒé…ç½®ç®¡ç†
- [x] global_seq å…¨å±€åºåˆ—å·
- [x] sync_seq åŒæ­¥åºåˆ—å·
- [x] pending_sync ä½æ©ç 
- [x] Schema ç‰ˆæœ¬å­˜å‚¨

### ts_config_schemas - Schema å®šä¹‰
- [x] NET æ¨¡å— Schema (7 é¡¹: eth.enabled, eth.dhcp, eth.ip...)
- [x] DHCP æ¨¡å— Schema (6 é¡¹: enabled, start_ip, end_ip...)
- [x] WIFI æ¨¡å— Schema (9 é¡¹: mode, ap.ssid, sta.ssid...)
- [x] LED æ¨¡å— Schema (8 é¡¹: brightness, effect_speed, matrix.rotation...)
- [x] FAN æ¨¡å— Schema (11 é¡¹: mode, min_duty, curve.t1...)
- [x] DEVICE æ¨¡å— Schema (7 é¡¹: agx.auto_power_on, monitor.interval...)
- [x] SYSTEM æ¨¡å— Schema (8 é¡¹: timezone, log_level, console.baudrate...)

### CLI å‘½ä»¤å¢å¼º
- [x] `config --allsave` - ä¿å­˜æ‰€æœ‰æ¨¡å—
- [x] `net --save` - ä¿å­˜ç½‘ç»œé…ç½®
- [x] `dhcp --save` - ä¿å­˜ DHCP é…ç½®
- [x] `wifi --save` - ä¿å­˜ WiFi é…ç½®
- [x] `led --save` - ä¿å­˜ LED é…ç½®
- [x] `fan --save` - ä¿å­˜é£æ‰‡é…ç½®
- [x] `device --save` - ä¿å­˜è®¾å¤‡é…ç½®
- [x] `system --save` - ä¿å­˜ç³»ç»Ÿé…ç½®

### æ–‡æ¡£
- [x] ç»Ÿä¸€é…ç½®ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ (CONFIG_SYSTEM_DESIGN.md)
- [x] GPIO å¼•è„šæ˜ å°„æ–‡æ¡£ (GPIO_MAPPING.md)

---

## ğŸ“‹ Phase 10: WebUI å¢å¼º & SSH Shell âœ…

### WebUI SPA é‡æ„
- [x] SPA è·¯ç”±å™¨å®ç° (router.js)
- [x] Hash è·¯ç”± (#/path) æ”¯æŒ
- [x] é¡µé¢æ‡’åŠ è½½å’ŒçŠ¶æ€ç®¡ç†
- [x] WebSocket è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨

### Web ç»ˆç«¯ (xterm.js)
- [x] xterm.js ç»ˆç«¯é›†æˆ
- [x] æœ¬åœ° CLI å‘½ä»¤æ‰§è¡Œ
- [x] å‘½ä»¤å†å²å’Œå…‰æ ‡ç¼–è¾‘
- [x] ANSI é¢œè‰²æ”¯æŒ
- [x] å¿ƒè·³ä¿æ´»æœºåˆ¶ï¼ˆ15ç§’é—´éš”ï¼‰

### SSH Shell WebSocket
- [x] WebSocket SSH æ¶ˆæ¯åè®® (ssh_connect/ssh_input/ssh_output/ssh_status)
- [x] libssh2 SSH ä¼šè¯ç®¡ç†
- [x] PTY ç»ˆç«¯åˆ†é…
- [x] åŒå‘æ•°æ®æµè½¬å‘
- [x] ssh_poll ä»»åŠ¡èµ„æºæ¸…ç†
- [x] è¿œç¨‹å…³é—­æ£€æµ‹å’Œæ¸…ç†

### Core API æ‰©å±•
- [x] ts_api_wifi.c - WiFi çŠ¶æ€/æ‰«æ/è¿æ¥/æ–­å¼€
- [x] ts_api_dhcp.c - DHCP çŠ¶æ€/å®¢æˆ·ç«¯/å¯åŠ¨/åœæ­¢
- [x] ts_api_nat.c - NAT çŠ¶æ€/å¯ç”¨/ç¦ç”¨/ä¿å­˜
- [x] ts_api_ssh.c - SSH æ‰§è¡Œ/æµ‹è¯•/å¯†é’¥ç”Ÿæˆ
- [x] ts_api_sftp.c - SFTP ls/get/put/rm/mkdir/stat
- [x] ts_api_key.c - å¯†é’¥åˆ—è¡¨/ä¿¡æ¯/ç”Ÿæˆ/åˆ é™¤
- [x] ts_api_hosts.c - Known Hosts ç®¡ç†
- [x] ts_api_agx.c - AGX ç›‘æ§çŠ¶æ€/æ•°æ®/é…ç½®/å¯åœ

### ç”µæºç›‘æ§æœåŠ¡
- [x] Power æœåŠ¡æ³¨å†Œ (ts_services.c)
- [x] ç”µæºç›‘æ§åˆå§‹åŒ–å’Œå¯åŠ¨
- [x] ç”µå‹ä¿æŠ¤ç­–ç•¥å¯åŠ¨
- [x] WebSocket ç”µå‹ä¿æŠ¤äº‹ä»¶å¹¿æ’­

### æ–‡ä»¶ç®¡ç†ç³»ç»Ÿ
- [x] Storage API æ‰©å±• (ts_api_storage.c)
  - storage.status - å­˜å‚¨çŠ¶æ€æŸ¥è¯¢
  - storage.list - ç›®å½•åˆ—è¡¨
  - storage.delete - æ–‡ä»¶/ç›®å½•åˆ é™¤
  - storage.mkdir - åˆ›å»ºç›®å½•
  - storage.rename - é‡å‘½å
  - storage.info - æ–‡ä»¶ä¿¡æ¯
- [x] æ–‡ä»¶ä¼ è¾“ç«¯ç‚¹ (ts_webui_api.c)
  - GET /api/v1/file/download?path=xxx - æ–‡ä»¶ä¸‹è½½
  - POST /api/v1/file/upload?path=xxx - æ–‡ä»¶ä¸Šä¼ 
  - URL è§£ç æ”¯æŒ (%XX ç¼–ç è·¯å¾„)
  - å®‰å…¨æ£€æŸ¥ (ä¸Šä¼ ä»…é™ /sdcard)
- [x] WebUI æ–‡ä»¶ç®¡ç†é¡µé¢
  - åˆ†åŒºåˆ‡æ¢ (SDå¡ / SPIFFS)
  - ç›®å½•å¯¼èˆª (é¢åŒ…å±‘è·¯å¾„)
  - æ–‡ä»¶åˆ—è¡¨ (åç§°/å¤§å°/ç±»å‹)
  - æ–‡ä»¶ä¸Šä¼  (å¤šæ–‡ä»¶æ”¯æŒ)
  - æ–‡ä»¶ä¸‹è½½
  - æ–°å»ºæ–‡ä»¶å¤¹
  - é‡å‘½å
  - åˆ é™¤

### é…ç½®ä¼˜åŒ–
- [x] CONFIG_LWIP_MAX_SOCKETS=16ï¼ˆè§£å†³ socket ç”¨å°½é—®é¢˜ï¼‰
- [x] ssh_poll ä»»åŠ¡æ ˆ 8192 å­—èŠ‚ï¼ˆè§£å†³æ ˆæº¢å‡ºé—®é¢˜ï¼‰

---

## ï¿½ Phase 11: OTA å›ºä»¶å‡çº§ âœ…

### ts_ota - OTA å‡çº§ç»„ä»¶
- [x] OTA ä¸»æ¡†æ¶ (ts_ota.c)
  - çŠ¶æ€ç®¡ç† (IDLE/CHECKING/DOWNLOADING/VERIFYING/WRITING/PENDING_REBOOT/ERROR)
  - è¿›åº¦è·Ÿè¸ª (ç™¾åˆ†æ¯”/å·²æ¥æ”¶/æ€»å¤§å°/çŠ¶æ€æ¶ˆæ¯)
  - äº’æ–¥ä¿æŠ¤ (çº¿ç¨‹å®‰å…¨)
  - äº‹ä»¶å‘å¸ƒ (TS_EVENT_BASE_OTA)
- [x] HTTPS OTA (ts_ota_https.c)
  - esp_https_ota é›†æˆ
  - è¯ä¹¦éªŒè¯ (CA bundle / è‡ªå®šä¹‰è¯ä¹¦ / è·³è¿‡éªŒè¯)
  - è¿›åº¦å›è°ƒ
  - ç‰ˆæœ¬æ¯”è¾ƒ (ç¦æ­¢é™çº§é€‰é¡¹)
- [x] SD å¡ OTA (ts_ota_sdcard.c)
  - æœ¬åœ°å›ºä»¶æ–‡ä»¶åŠ è½½
  - ESP é•œåƒå¤´éªŒè¯
  - åˆ†å—å†™å…¥ (4KB buffer)
  - å›ºä»¶åˆ—è¡¨æ‰«æ
- [x] å›æ»šæœºåˆ¶ (ts_ota_rollback.c)
  - å›ºä»¶éªŒè¯è®¡æ—¶å™¨ (é»˜è®¤60ç§’)
  - ts_ota_mark_valid() ç¡®è®¤å›ºä»¶
  - è‡ªåŠ¨å›æ»š (è¶…æ—¶æœªç¡®è®¤)
  - åˆ†åŒºä¿¡æ¯æŸ¥è¯¢
  - NVS å‡çº§è®°å½• (æ—¶é—´æˆ³/è®¡æ•°)
- [x] ç‰ˆæœ¬ç®¡ç† (ts_ota_version.c)
  - è¯­ä¹‰åŒ–ç‰ˆæœ¬è§£æ (x.y.z[-prerelease])
  - ç‰ˆæœ¬æ¯”è¾ƒ (major/minor/patch/prerelease)
  - è¿è¡Œå›ºä»¶ç‰ˆæœ¬æŸ¥è¯¢
  - ç‰ˆæœ¬æ ¼å¼åŒ–è¾“å‡º

### OTA Core API (ts_api_ota.c)
- [x] `ota.status` - è·å– OTA çŠ¶æ€ (è¿è¡Œåˆ†åŒº/ä¸‹ä¸€åˆ†åŒº/å¾…éªŒè¯)
- [x] `ota.progress` - è·å–å‡çº§è¿›åº¦ (ç™¾åˆ†æ¯”/å·²æ¥æ”¶/æ€»å¤§å°)
- [x] `ota.version` - è·å–å›ºä»¶ç‰ˆæœ¬ä¿¡æ¯
- [x] `ota.start_url` - ä» URL å¯åŠ¨ OTA (auto_reboot/allow_downgrade/skip_verify)
- [x] `ota.start_file` - ä» SD å¡å¯åŠ¨ OTA
- [x] `ota.abort` - ä¸­æ­¢å‡çº§
- [x] `ota.validate` - æ ‡è®°å›ºä»¶æœ‰æ•ˆ (å–æ¶ˆå›æ»š)
- [x] `ota.rollback` - å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
- [x] `ota.upload_begin` - å¼€å§‹å›ºä»¶ä¸Šä¼  (WebUI)
- [x] `ota.upload_end` - ç»“æŸå›ºä»¶ä¸Šä¼ 
- [x] `ota.upload_abort` - ä¸­æ­¢å›ºä»¶ä¸Šä¼ 

### OTA CLI å‘½ä»¤ (ts_cmd_ota.c)
- [x] `ota --status` - æ˜¾ç¤º OTA çŠ¶æ€
- [x] `ota --progress` - æ˜¾ç¤ºå‡çº§è¿›åº¦ (å«è¿›åº¦æ¡)
- [x] `ota --version` - æ˜¾ç¤ºå›ºä»¶ç‰ˆæœ¬
- [x] `ota --partitions` - æ˜¾ç¤ºåˆ†åŒºä¿¡æ¯
- [x] `ota --url <url>` - ä» HTTPS URL å‡çº§
- [x] `ota --file <path>` - ä» SD å¡æ–‡ä»¶å‡çº§
- [x] `ota --validate` - æ ‡è®°å›ºä»¶æœ‰æ•ˆ
- [x] `ota --rollback` - å›æ»šåˆ°ä¸Šä¸€ç‰ˆæœ¬
- [x] `ota --abort` - ä¸­æ­¢å‡çº§
- [x] `--no-reboot` é€‰é¡¹ - å‡çº§åä¸è‡ªåŠ¨é‡å¯
- [x] `--allow-downgrade` é€‰é¡¹ - å…è®¸é™çº§
- [x] `--skip-verify` é€‰é¡¹ - è·³è¿‡è¯ä¹¦éªŒè¯
- [x] `--json` é€‰é¡¹ - JSON æ ¼å¼è¾“å‡º

### åˆ†åŒºè¡¨ (partitions_ota.csv)
- [x] åŒ OTA åˆ†åŒº (ota_0 + ota_1, å„ 3MB)
- [x] OTA æ•°æ®åˆ†åŒº (otadata, 8KB)
- [x] www åˆ†åŒºæ‰©å±•è‡³ 2MB (WebUI + é™æ€èµ„æº)
- [x] 16MB Flash å¸ƒå±€ä¼˜åŒ–

### Kconfig é…ç½®
- [x] CONFIG_TS_OTA_ENABLED - OTA åŠŸèƒ½å¼€å…³
- [x] CONFIG_TS_OTA_ROLLBACK_TIMEOUT - å›æ»šè¶…æ—¶ (10-300ç§’)
- [x] CONFIG_TS_OTA_HTTPS_ENABLED - HTTPS OTA å¼€å…³
- [x] CONFIG_TS_OTA_SDCARD_ENABLED - SD å¡ OTA å¼€å…³
- [x] CONFIG_TS_OTA_WEBUI_UPLOAD_ENABLED - WebUI ä¸Šä¼ å¼€å…³
- [x] CONFIG_TS_OTA_BUFFER_SIZE - ç¼“å†²åŒºå¤§å° (1-16KB)
- [x] CONFIG_TS_OTA_VERIFY_SIGNATURE - å›ºä»¶ç­¾åéªŒè¯ (å¯é€‰)
- [x] CONFIG_TS_OTA_ANTI_ROLLBACK - é˜²å›æ»šä¿æŠ¤ (å¯é€‰)
- [x] CONFIG_TS_OTA_VERSION_CHECK - ç‰ˆæœ¬æ£€æŸ¥å¼€å…³
- [x] CONFIG_TS_OTA_DEFAULT_URL - é»˜è®¤ OTA æœåŠ¡å™¨ URL
- [x] CONFIG_TS_OTA_TASK_STACK_SIZE - ä»»åŠ¡æ ˆå¤§å° (4-16KB)
- [x] CONFIG_TS_OTA_TASK_PRIORITY - ä»»åŠ¡ä¼˜å…ˆçº§ (1-24)

---
## ğŸ“‹ Phase 12: OTA å¢å¼º & Bugä¿®å¤ âœ…

### OTA å›æ»šæœºåˆ¶ä¿®å¤
- [x] ä¿®å¤ `ts_ota_is_pending_verify()` è¿”å›å€¼é”™è¯¯
  - é—®é¢˜ï¼šæ–°å›ºä»¶é¦–æ¬¡å¯åŠ¨æ—¶è¯¯åˆ¤ä¸ºã€Œæ— éœ€éªŒè¯ã€
  - åŸå› ï¼š`s_rollback_timer` åœ¨è®¡æ—¶å™¨åˆ›å»ºå‰ä¸º NULL
  - è§£å†³ï¼šæ£€æŸ¥ OTA çŠ¶æ€å’Œåˆ†åŒºçŠ¶æ€è€Œéè®¡æ—¶å™¨å¥æŸ„
- [x] ä¿®å¤ `ts_ota_mark_valid()` ç›´æ¥è°ƒç”¨ SDK è€Œéç»„ä»¶å±‚
  - ä¿®æ”¹ä¸ºè°ƒç”¨ `ts_ota_rollback_cancel()`

### WebUI OTA å›æ»šåŠŸèƒ½
- [x] é¦–é¡µæ–°å›ºä»¶éªŒè¯æ¨ªå¹…
  - å€’è®¡æ—¶æ˜¾ç¤ºï¼ˆ60ç§’ï¼‰
  - ç¡®è®¤å›ºä»¶ / ç«‹å³å›æ»šæŒ‰é’®
  - è‡ªåŠ¨åˆ·æ–°å€’è®¡æ—¶
- [x] OTA é¡µé¢æ‰‹åŠ¨éªŒè¯/å›æ»šæ§åˆ¶
  - æ˜¾ç¤ºéªŒè¯çŠ¶æ€å’Œå‰©ä½™æ—¶é—´
  - ç¡®è®¤å›ºä»¶å’Œå›æ»šæŒ‰é’®
- [x] ä¿®å¤ OTA è¿›åº¦æ˜¾ç¤º
  - ä¿®å¤è¿›åº¦æ¡ä¸æ›´æ–°é—®é¢˜
  - ä¿®å¤ä¸Šä¼ æ–¹å¼æ— è¿›åº¦æ˜¾ç¤º
  - æ·»åŠ  keepalive æœºåˆ¶é˜²æ­¢ HTTP è¶…æ—¶

### æ‰‹åŠ¨å‡çº§ www åˆ†åŒºæ”¯æŒ
- [x] WebUI ä¸¤ç§æ‰‹åŠ¨å‡çº§æ–¹å¼æ·»åŠ  "åŒ…å« WebUI" å¤é€‰æ¡†
  - URL å‡çº§ï¼šå‹¾é€‰åä¾æ¬¡å‡çº§ app + www åˆ†åŒº
  - SD å¡å‡çº§ï¼šå‹¾é€‰åä¾æ¬¡å‡çº§ app + www åˆ†åŒº
- [x] æ–°å¢ `ota.www.start_sdcard` API
  - ä» SD å¡æ–‡ä»¶å‡çº§ www (SPIFFS) åˆ†åŒº
  - è·¯å¾„æ¨æ–­ï¼š`/sdcard/firmware.bin` â†’ `/sdcard/www.bin`
- [x] `ts_ota_www.c` æ–°å¢ SD å¡ www OTA å®ç°
  - `ts_ota_www_start_sdcard()` å¯åŠ¨å‡½æ•°
  - `www_ota_sdcard_task()` å¼‚æ­¥ä»»åŠ¡
  - åˆ†åŒºæ“¦é™¤ã€åˆ†å—å†™å…¥ã€è¿›åº¦å›è°ƒ

### Core API æ‰©å±•
- [x] `ota.www.start_sdcard` - ä» SD å¡å‡çº§ www åˆ†åŒº
- [x] `ota.https.start` - æ”¯æŒ `www_url` å‚æ•°

---

## ğŸ“‹ Phase 13: æ—¥å¿—ç³»ç»Ÿå¢å¼º âœ…

### ts_log - æ—¥å¿—ç³»ç»Ÿæ ¸å¿ƒå¢å¼º
- [x] ESP_LOG æ•è·é’©å­
  - å®‰è£… `vprintf` é’©å­æ‹¦æˆªæ‰€æœ‰ ESP_LOG è¾“å‡º
  - è§£æ ESP_LOG æ ¼å¼ï¼ˆæ—¶é—´æˆ³ã€çº§åˆ«ã€TAGã€æ¶ˆæ¯ï¼‰
  - å»é™¤ ANSI é¢œè‰²ä»£ç ï¼Œæå–çº¯æ–‡æœ¬
  - é˜²é€’å½’ä¿æŠ¤ï¼ˆé¿å…æ—¥å¿—é£æš´ï¼‰
- [x] æ—¥å¿—ç¼“å†²åŒºæ‰©å±•
  - é»˜è®¤å®¹é‡ä» 100 å¢åŠ åˆ° 1000 æ¡
  - Kconfig å¯é…ç½®èŒƒå›´ 50-5000
  - æ¯æ¡çº¦ 300 å­—èŠ‚ï¼Œ1000 æ¡çº¦ 300KB
- [x] æ—¥å¿—ç»Ÿè®¡ API
  - `ts_log_get_stats()` - è·å–ç¼“å†²åŒºå®¹é‡ã€æ•°é‡ã€ä¸¢å¼ƒæ•°
  - `ts_log_buffer_search()` - æ”¯æŒçº§åˆ«/TAG/å…³é”®å­—è¿‡æ»¤æœç´¢
  - `ts_log_enable_esp_capture()` - åŠ¨æ€å¯ç”¨/ç¦ç”¨æ•è·
- [x] Kconfig é…ç½®é¡¹
  - `CONFIG_TS_LOG_BUFFER_SIZE` - ç¼“å†²åŒºå¤§å°ï¼ˆé»˜è®¤ 1000ï¼‰
  - `CONFIG_TS_LOG_CAPTURE_ESP_LOG` - ESP_LOG æ•è·å¼€å…³

### Log Core API (ts_api_log.c)
- [x] `log.list` - è·å–æ—¥å¿—åˆ—è¡¨
  - æ”¯æŒåˆ†é¡µï¼ˆoffset/limitï¼‰
  - æ”¯æŒçº§åˆ«è¿‡æ»¤ï¼ˆminLevel/maxLevelï¼‰
  - æ”¯æŒ TAG å­å­—ç¬¦ä¸²åŒ¹é…
  - æ”¯æŒå…³é”®å­—å…¨æ–‡æœç´¢
- [x] `log.stats` - è·å–æ—¥å¿—ç»Ÿè®¡ä¿¡æ¯
  - ç¼“å†²åŒºå®¹é‡/æ•°é‡
  - æ€»æ•è·æ•°/ä¸¢å¼ƒæ•°
  - å½“å‰æ—¥å¿—çº§åˆ«
- [x] `log.clear` - æ¸…ç©ºæ—¥å¿—ç¼“å†²åŒº
- [x] `log.setLevel` - è®¾ç½®æ—¥å¿—çº§åˆ«ï¼ˆå…¨å±€æˆ–æŒ‰ TAGï¼‰
- [x] `log.capture` - æ§åˆ¶ ESP_LOG æ•è·å¼€å…³

### WebSocket æ—¥å¿—æµ (ts_webui_ws.c)
- [x] æ–°å¢ `WS_CLIENT_TYPE_LOG` å®¢æˆ·ç«¯ç±»å‹
- [x] WebSocket æ¶ˆæ¯åè®®
  - `log_subscribe` - è®¢é˜…æ—¥å¿—æµï¼ˆæ”¯æŒ minLevel è¿‡æ»¤ï¼‰
  - `log_unsubscribe` - å–æ¶ˆè®¢é˜…
  - `log_set_level` - æ›´æ–°çº§åˆ«è¿‡æ»¤
  - `log_get_history` - è·å–å†å²æ—¥å¿—ï¼ˆæœ€å¤š 500 æ¡ï¼‰
- [x] å®æ—¶æ—¥å¿—æ¨é€
  - æ—¥å¿—å›è°ƒæ³¨å†Œåˆ° `ts_log`
  - æŒ‰å®¢æˆ·ç«¯çº§åˆ«è¿‡æ»¤åæ¨é€
  - JSON æ ¼å¼ï¼štimestamp/level/levelName/tag/message/task
- [x] æ™ºèƒ½æµæ§åˆ¶
  - æ— è®¢é˜…å®¢æˆ·ç«¯æ—¶è‡ªåŠ¨ç¦ç”¨å›è°ƒ
  - å®¢æˆ·ç«¯æ–­å¼€æ—¶è‡ªåŠ¨æ›´æ–°çŠ¶æ€

### WebUI æ—¥å¿—é¡µé¢ (app.js)
- [x] å…¨æ–°æ—¥å¿—æŸ¥çœ‹ç•Œé¢
  - æ·±è‰²ç»ˆç«¯é£æ ¼ï¼ˆ#1a1a2e èƒŒæ™¯ï¼‰
  - ç­‰å®½å­—ä½“ï¼ˆSF Mono/Monaco/Consolasï¼‰
  - æ—¥å¿—çº§åˆ«é¢œè‰²é«˜äº®ï¼ˆERROR çº¢/WARN æ©™/INFO ç»¿/DEBUG è“ï¼‰
- [x] å·¥å…·æ åŠŸèƒ½
  - çº§åˆ«è¿‡æ»¤ä¸‹æ‹‰æ¡†ï¼ˆå…¨éƒ¨/ERROR/WARN+/INFO+/DEBUG+ï¼‰
  - TAG è¿‡æ»¤è¾“å…¥æ¡†
  - å…³é”®å­—æœç´¢ï¼ˆæ”¯æŒé«˜äº®ï¼‰
  - WebSocket çŠ¶æ€æŒ‡ç¤ºå™¨
  - è‡ªåŠ¨æ»šåŠ¨å¼€å…³
  - åŠ è½½å†å²/æ¸…ç©ºæŒ‰é’®
- [x] å®æ—¶æ—¥å¿—æµ
  - WebSocket è®¢é˜…åè‡ªåŠ¨æ¨é€
  - å‰ç«¯æœ€å¤§ä¿ç•™ 1000 æ¡
  - é˜²æŠ–åŠ¨è¿‡æ»¤æ¸²æŸ“
- [x] å“åº”å¼å¸ƒå±€
  - ç§»åŠ¨ç«¯è‡ªé€‚åº”
  - å·¥å…·æ æ¢è¡Œå¸ƒå±€

### WebUI é›†æˆ
- [x] å¯¼èˆªæ æ·»åŠ ã€Œæ—¥å¿—ã€å…¥å£
- [x] SPA è·¯ç”±æ³¨å†Œ `/logs`
- [x] TianShanWS æ·»åŠ  `readyState` getter

---
## ğŸ“ å¼€å‘æ—¥å¿—

### 2026-01-23
- **æ—¥å¿—ç³»ç»Ÿå¢å¼º**ï¼š
  - å®ç° ESP_LOG æ•è·é’©å­ï¼Œè‡ªåŠ¨è§£æ ESP-IDF æ‰€æœ‰æ—¥å¿—
  - æ—¥å¿—ç¼“å†²åŒºæ‰©å±•åˆ° 1000 æ¡ï¼Œæ”¯æŒ WebUI é•¿æ—¶é—´æŸ¥çœ‹
  - æ–°å¢ WebSocket æ—¥å¿—æµåè®®ï¼Œæ”¯æŒå®æ—¶æ¨é€å’Œå†å²æŸ¥è¯¢
  - WebUI æ–°å¢æ—¥å¿—é¡µé¢ï¼Œæ”¯æŒå®æ—¶æŸ¥çœ‹ã€è¿‡æ»¤ã€æœç´¢ã€æ¸…ç©º
  - Log Core API 5 ä¸ªç«¯ç‚¹ï¼šlist/stats/clear/setLevel/capture

- **OTA å›æ»šæœºåˆ¶ä¿®å¤**ï¼š
  - ä¿®å¤ `ts_ota_is_pending_verify()` è¯¯åˆ¤é—®é¢˜
    - é—®é¢˜ï¼šæ–°å›ºä»¶é¦–æ¬¡å¯åŠ¨æ—¶ï¼Œå‡½æ•°è¿”å› falseï¼ˆæ— éœ€éªŒè¯ï¼‰
    - åŸå› ï¼šä¾èµ– `s_rollback_timer` å¥æŸ„åˆ¤æ–­ï¼Œä½†è®¡æ—¶å™¨åœ¨å‡½æ•°è°ƒç”¨åæ‰åˆ›å»º
    - ä¿®å¤ï¼šæ”¹ç”¨ OTA çŠ¶æ€ + åˆ†åŒºçŠ¶æ€åˆ¤æ–­ï¼ˆ`esp_ota_check_rollback_is_possible()`ï¼‰
  - ä¿®å¤ `ts_ota_mark_valid()` è°ƒç”¨é“¾
    - é—®é¢˜ï¼šç›´æ¥è°ƒç”¨ SDK `esp_ota_mark_app_valid_cancel_rollback()` ç»•è¿‡ç»„ä»¶å±‚
    - ä¿®å¤ï¼šæ”¹ä¸ºè°ƒç”¨ `ts_ota_rollback_cancel()` ç»Ÿä¸€ç®¡ç†

- **WebUI OTA å›æ»šåŠŸèƒ½**ï¼š
  - é¦–é¡µæ–°å›ºä»¶éªŒè¯æ¨ªå¹…
    - é†’ç›®çš„é»„è‰²èƒŒæ™¯æç¤º
    - å®æ—¶å€’è®¡æ—¶æ˜¾ç¤ºï¼ˆå‰©ä½™ XX ç§’ï¼‰
    - ã€Œç¡®è®¤å›ºä»¶ã€å’Œã€Œç«‹å³å›æ»šã€æŒ‰é’®
  - OTA é¡µé¢éªŒè¯æ§åˆ¶
    - å½“å‰éªŒè¯çŠ¶æ€æ˜¾ç¤º
    - å‰©ä½™æ—¶é—´å€’è®¡æ—¶
    - æ‰‹åŠ¨ç¡®è®¤/å›æ»šæ“ä½œ
  - ä¿®å¤ OTA è¿›åº¦æ˜¾ç¤ºé—®é¢˜
    - é—®é¢˜ï¼šè¿›åº¦æ¡å¡åœ¨ 0% ä¸æ›´æ–°
    - åŸå› ï¼šå®šæ—¶å™¨ ID æœªä¿å­˜å¯¼è‡´æ— æ³•æ¸…é™¤
    - ä¿®å¤ï¼šæ­£ç¡®ç®¡ç† `pollInterval` å˜é‡
  - ä¿®å¤ä¸Šä¼ æ–¹å¼æ— è¿›åº¦æ˜¾ç¤º
    - æ·»åŠ  keepalive å®šæ—¶å™¨ï¼Œæ¯ 5 ç§’è°ƒç”¨ ota.progress

- **æ‰‹åŠ¨å‡çº§ www åˆ†åŒºæ”¯æŒ**ï¼š
  - WebUI æ‰‹åŠ¨å‡çº§å¢å¼º
    - URL å‡çº§æ–¹å¼æ·»åŠ ã€ŒåŒ…å« WebUIã€å¤é€‰æ¡†ï¼ˆé»˜è®¤å‹¾é€‰ï¼‰
    - SD å¡å‡çº§æ–¹å¼æ·»åŠ ã€ŒåŒ…å« WebUIã€å¤é€‰æ¡†ï¼ˆé»˜è®¤å‹¾é€‰ï¼‰
    - å‹¾é€‰åæ‰§è¡Œä¸¤æ­¥ OTAï¼šå…ˆ app åˆ†åŒºï¼Œå www åˆ†åŒº
  - æ–°å¢ `ota.www.start_sdcard` API
    - ä» SD å¡æ–‡ä»¶å‡çº§ www (SPIFFS) åˆ†åŒº
    - æ–‡ä»¶è·¯å¾„æ¨æ–­è§„åˆ™ï¼š`/sdcard/firmware.bin` â†’ `/sdcard/www.bin`
  - å®ç° `ts_ota_www_start_sdcard()` å‡½æ•°
    - æ–‡ä»¶å­˜åœ¨æ€§æ£€æŸ¥
    - æ–‡ä»¶å¤§å°è·å–
    - å¼‚æ­¥ä»»åŠ¡å¯åŠ¨
  - å®ç° `www_ota_sdcard_task()` å¼‚æ­¥ä»»åŠ¡
    - æŸ¥æ‰¾ www åˆ†åŒºï¼ˆSPIFFS ç±»å‹ï¼‰
    - åˆ†åŒºæ“¦é™¤
    - åˆ†å—è¯»å–æ–‡ä»¶å¹¶å†™å…¥åˆ†åŒºï¼ˆ4KB bufferï¼‰
    - è¿›åº¦å›è°ƒ
    - é”™è¯¯å¤„ç†å’ŒçŠ¶æ€æ›´æ–°

### 2026-01-22
- **ç»Ÿä¸€é…ç½®ç³»ç»Ÿä¿®å¤**ï¼š
  - ä¿®å¤ `MODULE_NAMES` æ•°ç»„ç¼ºå°‘ `NAT` æ¡ç›®å¯¼è‡´å´©æºƒ
    - é—®é¢˜ï¼š`strlen(NULL)` åœ¨ `ts_config_module_register()` è§¦å‘ LoadProhibited
    - ä¿®å¤ï¼šåœ¨ `ts_config_module.c` ä¸­æ·»åŠ  `[TS_CONFIG_MODULE_NAT] = "NAT"`
  - ä¸º NAT æ¨¡å—æ·»åŠ ç»Ÿä¸€é…ç½®æ”¯æŒ
    - `ts_config_module.h` æ·»åŠ  `TS_CONFIG_MODULE_NAT` æšä¸¾
    - `ts_config_schemas.c` æ·»åŠ  NAT schema å®šä¹‰ (enabled, auto_start)
    - `ts_cmd_nat.c` æ›´æ–° `--save` ä½¿ç”¨åŒå†™æœºåˆ¶
    - `ts_api_config.c` æ·»åŠ  NAT æ¨¡å—è§£æ
  - ä¿®å¤ API æ§½ä½ä¸è¶³é—®é¢˜
    - `CONFIG_TS_API_MAX_ENDPOINTS` ä» 128 å¢åŠ åˆ° 200

- **WebUI ç½‘ç»œé…ç½®é¡µé¢é‡æ„**ï¼š
  - æ–°å¢çŠ¶æ€æ¦‚è§ˆåŒºï¼ˆé¡¶éƒ¨ä¸‰æ¥å£å¡ç‰‡ï¼šä»¥å¤ªç½‘/WiFi STA/WiFi APï¼‰
  - åŒæ å¸ƒå±€è®¾è®¡
    - å·¦æ ï¼šæ¥å£é…ç½®ï¼ˆä»¥å¤ªç½‘/WiFi æ ‡ç­¾é¡µåˆ‡æ¢ï¼‰
    - å³æ ï¼šç½‘ç»œæœåŠ¡ï¼ˆä¸»æœºå/DHCP/NATï¼‰
  - WiFi æ‰«æç»“æœæ”¹ä¸ºå¡ç‰‡å¼å¸ƒå±€ï¼ŒæŒ‰ä¿¡å·å¼ºåº¦æ’åº
  - è®¾å¤‡åˆ—è¡¨ï¼ˆAP æ¥å…¥è®¾å¤‡/DHCP å®¢æˆ·ç«¯ï¼‰æ”¹ä¸ºç½‘æ ¼å¡ç‰‡
  - è§†è§‰ä¼˜åŒ–
    - çŠ¶æ€ç‚¹ï¼ˆç»¿/çº¢/ç°ï¼‰æ›¿ä»£æ–‡å­—çŠ¶æ€
    - æœåŠ¡å¾½ç« æ˜¾ç¤ºè¿è¡ŒçŠ¶æ€
    - ä¿¡å·å¼ºåº¦æ¡æ˜¾ç¤º (â–ˆâ–ˆâ–ˆâ–ˆ)
    - å“åº”å¼å¸ƒå±€æ”¯æŒç§»åŠ¨ç«¯
  - æ–°å¢ CSS æ ·å¼ï¼š500+ è¡Œç½‘ç»œé¡µé¢ä¸“ç”¨æ ·å¼

- **WebUI LED æ§åˆ¶é¡µé¢é‡æ„**ï¼š
  - **è®¾å¤‡å¡ç‰‡å…¨æ–°å¸ƒå±€**ï¼š
    - å¡ç‰‡å¼è®¾è®¡æ›¿ä»£æ—§ç‰ˆç´§å‡‘é¢æ¿
    - è®¾å¤‡çŠ¶æ€å®æ—¶æ˜¾ç¤ºï¼ˆå·²å…³é—­/å¸¸äº®/â–¶ç‰¹æ•ˆåç§°ï¼‰
    - è¾¹æ¡†é¢œè‰²æŒ‡ç¤ºå¼€å…³çŠ¶æ€ï¼ˆç»¿è‰²=å¼€å¯ï¼‰
  - **æ§åˆ¶åŒºåŸŸä¼˜åŒ–**ï¼š
    - äº®åº¦æ»‘å—ç‹¬ç«‹è¡Œï¼Œæ¸…æ™°å¯æ“ä½œ
    - é¢œè‰²é€‰æ‹©å™¨ + 8ä¸ªå¿«æ·é¢„è®¾è‰²åœ†ç‚¹
    - å¿«æ·ç‰¹æ•ˆæŒ‰é’®ï¼ˆå‰4ä¸ªï¼‰+ "æ›´å¤š"æŒ‰é’®
    - åœæ­¢æŒ‰é’®ç‹¬ç«‹æ˜¾ç¤º
  - **åº•éƒ¨æ“ä½œæ **ï¼š
    - ç”µæºæŒ‰é’®ï¼ˆå¼€å¯/å…³é—­çŠ¶æ€åˆ‡æ¢ï¼‰
    - Matrix ä¸“å±åŠŸèƒ½æŒ‰é’®ï¼ˆğŸ“·å›¾åƒ/ğŸ“æ–‡æœ¬/ğŸ¨æ»¤é•œï¼‰
    - ä¿å­˜æŒ‰é’®å›ºå®šå³ä¾§
  - **çŠ¶æ€åŒæ­¥**ï¼š
    - æ–°å¢ `updateLedCardState()` ç»Ÿä¸€çŠ¶æ€æ›´æ–°
    - å¿«æ·ç‰¹æ•ˆå®æ—¶é«˜äº®å½“å‰è¿è¡Œæ•ˆæœ
    - å…¨éƒ¨å…³é—­åŠŸèƒ½ `allLedsOff()`
  - **å“åº”å¼å¸ƒå±€**ï¼š
    - ç§»åŠ¨ç«¯å•åˆ—æ˜¾ç¤º
    - æŒ‰é’®å’Œé—´è·è‡ªé€‚åº”ç¼©æ”¾
  - æ–°å¢ CSS æ ·å¼ï¼š300+ è¡Œ LED é¡µé¢ä¸“ç”¨æ ·å¼

### 2026-01-21
- **WebUI æ–‡ä»¶ç®¡ç†åŠŸèƒ½**ï¼š
  - å®ç° Storage API æ‰©å±•
    - storage.delete - åˆ é™¤æ–‡ä»¶/ç›®å½•
    - storage.mkdir - åˆ›å»ºç›®å½•
    - storage.rename - é‡å‘½åæ–‡ä»¶/ç›®å½•
    - storage.info - è·å–æ–‡ä»¶è¯¦ç»†ä¿¡æ¯
  - å®ç°æ–‡ä»¶ä¼ è¾“ç«¯ç‚¹
    - GET /api/v1/file/download?path=xxx - æ–‡ä»¶ä¸‹è½½
    - POST /api/v1/file/upload?path=xxx - æ–‡ä»¶ä¸Šä¼ 
    - æ·»åŠ  url_decode() å‡½æ•°å¤„ç† URL ç¼–ç è·¯å¾„
    - å®‰å…¨æ£€æŸ¥ï¼šä¸Šä¼ ä»…é™ /sdcard ç›®å½•
  - å®ç° WebUI æ–‡ä»¶ç®¡ç†é¡µé¢
    - åˆ†åŒºåˆ‡æ¢ï¼ˆSDå¡ / SPIFFSï¼‰
    - ç›®å½•å¯¼èˆªï¼ˆé¢åŒ…å±‘è·¯å¾„ï¼‰
    - æ–‡ä»¶åˆ—è¡¨ï¼ˆåç§°/å¤§å°/ç±»å‹/å›¾æ ‡ï¼‰
    - æ–‡ä»¶ä¸Šä¼ ï¼ˆå¤šæ–‡ä»¶æ”¯æŒï¼‰
    - æ–‡ä»¶ä¸‹è½½
    - æ–°å»ºæ–‡ä»¶å¤¹
    - é‡å‘½å
    - åˆ é™¤
  - è°ƒè¯•ä¿®å¤ï¼š
    - ä¿®å¤ storageList API ä½¿ç”¨ GET æ— æ³•å‘é€ body é—®é¢˜ï¼ˆæ”¹ä¸º POSTï¼‰
    - ä¿®å¤ applyColor æœªå®šä¹‰å¯¼è‡´ JS æ‰§è¡Œä¸­æ–­
    - ä¿®å¤ URL ç¼–ç è·¯å¾„å¯¼è‡´ 403 Forbiddenï¼ˆæ·»åŠ  url_decodeï¼‰

- **SSH Shell WebSocket ä¿®å¤**ï¼š
  - ä¿®å¤ "Too many open files in system" é”™è¯¯
    - åŸå› ï¼šCONFIG_LWIP_MAX_SOCKETS=10 å¤ªå°
    - è§£å†³ï¼šå¢åŠ åˆ° 16 (sdkconfig + sdkconfig.defaults)
  - ä¿®å¤ ssh_poll ä»»åŠ¡æ ˆæº¢å‡º
    - åŸå› ï¼š4096 å­—èŠ‚æ ˆå¯¹ libssh2 ä¸è¶³
    - è§£å†³ï¼šå¢åŠ åˆ° 8192 å­—èŠ‚
  - ä¿®å¤ ssh_poll_task èµ„æºæ³„æ¼
    - åŸå› ï¼šè¿œç¨‹å…³é—­æ—¶æœªæ¸…ç† shell/session
    - è§£å†³ï¼šæ·»åŠ  need_cleanup æ ‡è®°å’Œå®Œæ•´æ¸…ç†é€»è¾‘

- **LED WebUI å¢å¼º**ï¼š
  - LED é¡µé¢å®Œæ•´å®ç°
    - è®¾å¤‡åˆ—è¡¨ï¼ˆtouch/board/matrixï¼‰
    - äº®åº¦æ»‘å—æ§åˆ¶
    - é¢œè‰²é€‰æ‹©å™¨ï¼ˆé¢„è®¾é¢œè‰² + è‡ªå®šä¹‰ï¼‰
    - ç‰¹æ•ˆé€‰æ‹©å’Œé€Ÿåº¦è°ƒèŠ‚
    - å›¾åƒä¸Šä¼ å’Œæ˜¾ç¤º
  - é…ç½®ä¿å­˜åŠŸèƒ½ï¼ˆled --saveï¼‰
  - çŠ¶æ€å®æ—¶å±•ç¤º

- **LED WebUI Matrix åŠŸèƒ½å¢å¼º**ï¼š
  - å®ç° Matrix ä¸“å±åŠŸèƒ½åŒºåŸŸï¼ˆå›¾åƒ/QRç /æ–‡æœ¬/æ»¤é•œï¼‰
  - **æ–‡ä»¶é€‰æ‹©å™¨ç»„ä»¶**
    - é€šç”¨ `openFilePickerFor(inputId, startPath)` å‡½æ•°
    - æ”¯æŒç›®å½•å¯¼èˆªã€æ–‡ä»¶é¢„è§ˆã€é€‰æ‹©ç¡®è®¤
    - å›¾åƒæ–‡ä»¶ç±»å‹è¿‡æ»¤ (.png/.jpg/.gif/.bmp)
  - **æ–‡æœ¬æ»šåŠ¨æ•ˆæœä¿®å¤**
    - ä» checkbox æ”¹ä¸ºä¸‹æ‹‰é€‰æ‹©å™¨
    - æ”¯æŒæ–¹å‘é€‰æ‹©ï¼šæ— /å‘å·¦/å‘å³/å‘ä¸Š/å‘ä¸‹
  - **å­—ä½“é€‰æ‹©å™¨ä¼˜åŒ–**
    - ç§»é™¤æ— æ•ˆçš„"é»˜è®¤å­—ä½“"é€‰é¡¹
    - åªæ˜¾ç¤º /sdcard/fonts å®é™…å­˜åœ¨çš„å­—ä½“æ–‡ä»¶
  - **QR Code èƒŒæ™¯å›¾æ”¯æŒ**
    - Core API (`led.qrcode`) æ·»åŠ  `bg_image` å‚æ•°
    - WebUI æ·»åŠ èƒŒæ™¯å›¾é€‰æ‹©å™¨ï¼ˆå¤ç”¨æ–‡ä»¶é€‰æ‹©å™¨ç»„ä»¶ï¼‰
    - NVS ä¿å­˜/æ¢å¤æ”¯æŒï¼ˆæ–°å¢ `{device}.qrbg` é”®ï¼‰
    - ä¿®å¤é‡å¯åèƒŒæ™¯å›¾ä¸¢å¤±é—®é¢˜
  - **åå¤„ç†æ»¤é•œå®Œæ•´å®ç°**
    - æ»¤é•œåˆ†ç±»å±•ç¤ºï¼šåŠ¨æ€/æ¸å˜/é™æ€æ•ˆæœ
    - é€Ÿåº¦å‚æ•°æ”¯æŒï¼ˆéƒ¨åˆ†æ»¤é•œï¼‰
    - API: `led.filter.start`, `led.filter.stop`

- **æ€§èƒ½ä¼˜åŒ–**ï¼š
  - CPU é¢‘ç‡ä» 160 MHz æ”¹ä¸º 240 MHz
  - ä¿®æ”¹ sdkconfig.defaults å’Œ sdkconfig

- **HTTP Server å¢å¼º**ï¼š
  - ä¿®å¤å¤§ body æ¥æ”¶ä¸å®Œæ•´é—®é¢˜
  - æ·»åŠ å¾ªç¯æ¥æ”¶ç›´åˆ°è·å–å®Œæ•´ content_len
  - HTTP/HTTPS handler ç»Ÿä¸€ä¿®å¤

- **WebUI API å¢å¼º**ï¼š
  - æ·»åŠ  query string è§£æï¼ˆ`?path=xxx` å‚æ•°ï¼‰
  - æ”¹è¿›é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç è¿”å›
  - æ·»åŠ  API è¯·æ±‚æ—¥å¿—

### 2026-01-20
- **WebUI SPA é‡æ„ï¼ˆPhase 10ï¼‰**ï¼š
  - å®ç° SPA è·¯ç”±ç³»ç»Ÿ (router.js)
    - Hash è·¯ç”± (#/path) æ”¯æŒ
    - é¡µé¢æ‡’åŠ è½½
    - å¯¼èˆªé«˜äº®åŒæ­¥
  - å®ç° Web ç»ˆç«¯ (terminal.js + xterm.js)
    - æœ¬åœ° CLI å‘½ä»¤æ‰§è¡Œ
    - SSH Shell æ”¯æŒï¼ˆé€šè¿‡ WebSocketï¼‰
    - å‘½ä»¤å†å²ã€å…‰æ ‡ç¼–è¾‘ã€ANSI é¢œè‰²
    - å¿ƒè·³ä¿æ´»ï¼ˆ15ç§’é—´éš”ï¼‰
    - Ctrl+\ é€€å‡º SSH Shell
  - å®ç° 7 ä¸ªå®Œæ•´é¡µé¢
    - ä»ªè¡¨ç›˜ï¼šç³»ç»Ÿ/å†…å­˜/ç½‘ç»œ/ç”µæº/è®¾å¤‡/æ¸©åº¦å¡ç‰‡
    - ç³»ç»Ÿç®¡ç†ï¼šæœåŠ¡åˆ—è¡¨ã€é‡å¯æ“ä½œ
    - LED æ§åˆ¶ï¼šè®¾å¤‡åˆ—è¡¨ã€äº®åº¦æ»‘å—ã€é¢œè‰²é€‰æ‹©ã€ç‰¹æ•ˆ
    - ç½‘ç»œé…ç½®ï¼šä»¥å¤ªç½‘/WiFi/DHCP/NAT çŠ¶æ€å’Œæ§åˆ¶
    - è®¾å¤‡æ§åˆ¶ï¼šAGX/LPMU ç”µæºã€é£æ‰‡è°ƒé€Ÿ
    - ç»ˆç«¯ï¼šWeb CLI + SSH Shell
    - å®‰å…¨ï¼šSSH è¿æ¥æµ‹è¯•ã€å¯†é’¥ç®¡ç†ã€å·²çŸ¥ä¸»æœº
    - é…ç½®ï¼šé…ç½®åˆ—è¡¨/ç­›é€‰/ç¼–è¾‘/åˆ é™¤
  - æ‰©å±• api.js æ”¯æŒæ‰€æœ‰ Core API ç«¯ç‚¹
  - æ·»åŠ  WebSocket è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨
  
- **Core API æ‰©å±•**ï¼š
  - ts_api_wifi.c - WiFi ç®¡ç† API
  - ts_api_dhcp.c - DHCP æœåŠ¡å™¨ API
  - ts_api_nat.c - NAT ç½‘å…³ API
  - ts_api_ssh.c - SSH æ‰§è¡Œ/æµ‹è¯• API
  - ts_api_sftp.c - SFTP æ–‡ä»¶ä¼ è¾“ API
  - ts_api_key.c - å¯†é’¥ç®¡ç† API
  - ts_api_hosts.c - Known Hosts API
  - ts_api_agx.c - AGX ç›‘æ§ API

- **SSH Shell WebSocket å®ç°**ï¼š
  - WebSocket æ¶ˆæ¯åè®®ï¼šssh_connect, ssh_input, ssh_output, ssh_status
  - libssh2 SSH ä¼šè¯å’Œ Shell ç®¡ç†
  - PTY ç»ˆç«¯åˆ†é…
  - åŒå‘æ•°æ®æµè½¬å‘ï¼ˆpoll ä»»åŠ¡ï¼‰
  - ç”µå‹ä¿æŠ¤äº‹ä»¶ WebSocket å¹¿æ’­

- **æœåŠ¡ç³»ç»Ÿæ‰©å±•**ï¼š
  - æ³¨å†Œ Power æœåŠ¡ï¼ˆç”µæºç›‘æ§ + ç”µå‹ä¿æŠ¤ï¼‰
  - æ³¨å†Œ WebUI æœåŠ¡ï¼ˆHTTP + WebSocket + é™æ€æ–‡ä»¶ï¼‰
  - www SPIFFS åˆ†åŒºæŒ‚è½½

### 2026-01-19
- **ç»Ÿä¸€é…ç½®ç³»ç»Ÿ (Phase 9) å®Œæˆ**ï¼š
  - åˆ›å»ºè®¾è®¡æ–‡æ¡£ (docs/CONFIG_SYSTEM_DESIGN.md)
    - SDå¡ä¼˜å…ˆ + NVS å¤‡ä»½åŒå†™åŒæ­¥æœºåˆ¶
    - æ—  RTC è®¾è®¡ï¼ˆåºåˆ—å·æ›¿ä»£æ—¶é—´æˆ³ï¼‰
    - pending_sync çƒ­æ’æ‹”å¤„ç†
    - Schema ç‰ˆæœ¬è¿ç§»æ¡†æ¶
  - å®ç° ts_config_module (ts_config_module.h/c)
    - 7 ä¸ªé…ç½®æ¨¡å—: NET, DHCP, WIFI, LED, FAN, DEVICE, SYSTEM
    - æ¨¡å—æ³¨å†Œ/åŠ è½½/æŒä¹…åŒ–/é‡ç½® API
    - SDå¡/NVS è‡ªåŠ¨ä¼˜å…ˆçº§é€‰æ‹©
    - JSON blob å­˜å‚¨ï¼ˆè§£å†³ NVS 15å­—ç¬¦é”®åé™åˆ¶ï¼‰
  - å®ç° ts_config_meta (ts_config_meta.h/c)
    - global_seq / sync_seq åºåˆ—å·ç®¡ç†
    - pending_sync ä½æ©ç ç®¡ç†
    - Schema ç‰ˆæœ¬å­˜å‚¨
  - å®ç° ts_config_schemas (ts_config_schemas.c)
    - 7 ä¸ªæ¨¡å—çš„ Schema å®šä¹‰ï¼ˆ50+ é…ç½®é¡¹ï¼‰
    - è‡ªåŠ¨æ³¨å†Œå’ŒåŠ è½½
  - CLI å‘½ä»¤å¢å¼ºï¼š
    - `config --allsave` - ä¸€é”®ä¿å­˜æ‰€æœ‰æ¨¡å—é…ç½®
    - 7 ä¸ªæ¨¡å— `--save` å‘½ä»¤: net, dhcp, wifi, led, fan, device, system
  - ä¿®å¤ NVS é”®åè¶…é•¿é”™è¯¯ï¼ˆJSON blob å­˜å‚¨æ–¹æ¡ˆï¼‰
  - åˆ›å»º GPIO å¼•è„šæ˜ å°„æ–‡æ¡£ (docs/GPIO_MAPPING.md)
  - æ›´æ–°æ¶æ„è®¾è®¡æ–‡æ¡£å¼•è„šå®šä¹‰ï¼ˆä¸ robOS/PCB ä¸€è‡´ï¼‰
  - ä¿®æ­£ SD å¡å¼•è„šã€è®¾å¤‡æ§åˆ¶å¼•è„šã€ç”µæºç›‘æ§å¼•è„š

### 2026-01-18
- **SSH é«˜çº§åŠŸèƒ½**ï¼š
  - å®ç°ç«¯å£è½¬å‘æ¨¡å— (ts_port_forward)
    - æœ¬åœ°ç«¯å£è½¬å‘ï¼š`-L localport:remotehost:remoteport`
    - ä½¿ç”¨ `libssh2_channel_direct_tcpip()` å»ºç«‹éš§é“
    - æ”¯æŒå¤šå¹¶å‘è¿æ¥ï¼ˆæœ€å¤š 5 ä¸ªï¼‰
    - åå°ä»»åŠ¡å¼‚æ­¥å¤„ç†æ•°æ®è½¬å‘
  - å®ç°äº¤äº’å¼ Shell æ¨¡å— (ts_ssh_shell)
    - PTY åˆ†é…ï¼š`libssh2_channel_request_pty_ex()`
    - æ”¯æŒ xterm/vt100/vt220/ansi/dumb ç»ˆç«¯ç±»å‹
    - åŒå‘ I/O å›è°ƒæœºåˆ¶
    - çª—å£å¤§å°è°ƒæ•´ï¼ˆSIGWINCHï¼‰æ”¯æŒ
    - ä¿¡å·å‘é€ï¼ˆCtrl+C ç­‰ï¼‰
  - CLI å‘½ä»¤æ‰©å±•ï¼š
    - `ssh --shell` - äº¤äº’å¼ Shell
    - `ssh --forward` - ç«¯å£è½¬å‘é…ç½®
  - è°ƒè¯•ä¿®å¤ï¼šäº¤äº’å¼ Shell å­—ç¬¦å›æ˜¾å»¶è¿Ÿé—®é¢˜
    - é—®é¢˜ï¼šè¾“å…¥å­—ç¬¦ä¸ç«‹å³æ˜¾ç¤ºï¼ŒæŒ‰å›è½¦åæ‰å¯è§
    - åŸå› ï¼šUART è¯»å– 50ms è¶…æ—¶é˜»å¡ä¸»å¾ªç¯
    - ä¿®å¤ï¼šéé˜»å¡ UART è¯»å– + fwrite/fflush ç«‹å³è¾“å‡º

### 2026-01-17
- **SSH å®‰å…¨åŠŸèƒ½å®Œå–„**ï¼š
  - å®ç° Known Hosts éªŒè¯ (ts_ssh_known_hosts)
    - ä¸»æœºå¯†é’¥æŒ‡çº¹éªŒè¯
    - SHA256 æŒ‡çº¹æ ¼å¼ï¼ˆOpenSSH å…¼å®¹ï¼‰
    - é¦–æ¬¡è¿æ¥ä¿¡ä»»ç­–ç•¥ï¼ˆTOFUï¼‰
    - NVS æŒä¹…åŒ–å­˜å‚¨
  - CLI å‘½ä»¤ï¼š`ssh --known-hosts list/remove/clear`

### 2026-01-16
- **LED æ–‡æœ¬æ˜¾ç¤ºç³»ç»Ÿ**ï¼š
  - å®ç° ttf2fnt.py å­—ä½“è½¬æ¢å·¥å…·ï¼ˆTTF â†’ .fnt åµŒå…¥å¼æ ¼å¼ï¼‰
  - å®ç° ts_led_font æ¨¡å—ï¼ˆå­—åº“åŠ¨æ€åŠ è½½, LRUç¼“å­˜, äºŒåˆ†æŸ¥æ‰¾ç´¢å¼•ï¼‰
  - å®ç° ts_led_text æ¨¡å—ï¼ˆUTF-8è§£æ, å¯¹é½, æ»šåŠ¨, è¦†ç›–å±‚æ¸²æŸ“ï¼‰
  - æ”¯æŒ BoutiqueBitmap9x9 åƒç´ å­—ä½“ï¼ˆASCII + GB2312ï¼‰
  - å®ç°æ–‡æœ¬è¦†ç›–å±‚ç³»ç»Ÿï¼ˆLayer 1ç‹¬ç«‹æ¸²æŸ“, ä¸åŠ¨ç”»/å›¾åƒå åŠ ï¼‰
  - å®ç°åè‰²è¦†ç›–æ¨¡å¼ï¼ˆ--invert, è‡ªåŠ¨æ£€æµ‹äº®è‰²èƒŒæ™¯ï¼‰
  - å®ç°å¾ªç¯æ»šåŠ¨ï¼ˆ--loop, æ–‡æœ¬æ»šå‡ºåé‡æ–°è¿›å…¥ï¼‰
  - ç”Ÿæˆæµ‹è¯•å­—åº“ï¼šboutique9x9.fnt (ASCII), cjk.fnt (GB2312)
  - CLIå‘½ä»¤ï¼š--draw-text, --stop-text, --font, --scroll, --align, --invert, --loop
  - æ›´æ–° COMMANDS.md æ–‡æ¡£

### 2026-01-18

- **å®‰å…¨åŠ å›ºï¼ˆL1 è½¯ä»¶å±‚ï¼‰**ï¼š
  - åˆ›å»ºç”Ÿäº§å®‰å…¨å®ç°è¿›åº¦æ–‡æ¡£ (docs/SECURITY_IMPLEMENTATION.md)
    - å®šä¹‰ L1-L4 å››çº§å®‰å…¨å±‚æ¬¡ï¼ˆå¼€å‘â†’é¢„ç”Ÿäº§â†’ç”Ÿäº§â†’é«˜å®‰å…¨ï¼‰
    - æ”»å‡»å‘é‡ä¸é˜²å¾¡ç­–ç•¥åˆ†æ
    - å®ç°æ¸…å•ä¸çŠ¶æ€è·Ÿè¸ª
  - **ç§é’¥ä¿æŠ¤**ï¼š
    - ç§»é™¤ `ts_keystore_export_to_file()` ç§é’¥å¯¼å‡ºèƒ½åŠ›
    - æ–°å¢ `ts_keystore_export_public_key_to_file()` ä»…å¯¼å‡ºå…¬é’¥
    - æ—§ API æ ‡è®°ä¸º deprecatedï¼Œè°ƒç”¨æ—¶è‡ªåŠ¨è½¬ä¸ºå…¬é’¥å¯¼å‡º
  - **å†…å­˜å®‰å…¨**ï¼š
    - æ–°å¢ `secure_free_key()` å‡½æ•°ï¼Œä½¿ç”¨ volatile æŒ‡é’ˆé˜²æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–
    - `ts_keystore_import_from_file()` å¯¼å…¥åç«‹å³æ¸…é›¶å†…å­˜
    - `ts_keystore_generate_key()` ç”Ÿæˆåç«‹å³æ¸…é›¶ä¸´æ—¶ç¼“å†²åŒº
  - **åˆ†åŒºè¡¨æ‰©å®¹**ï¼š
    - NVS åˆ†åŒºï¼š24KB â†’ 48KBï¼ˆæ”¯æŒ 8 ä¸ª RSA-4096 å¯†é’¥ï¼‰
    - æ–°å¢ nvs_keys åˆ†åŒºï¼ˆ4KBï¼ŒNVS åŠ å¯†æ”¯æŒï¼‰
    - factory åˆ†åŒºåç§»è°ƒæ•´ï¼š0x10000 â†’ 0x20000ï¼ˆ64KB å¯¹é½ï¼‰
  - **é…ç½®æ–‡ä»¶æ›´æ–°**ï¼š
    - sdkconfig.defaults æ·»åŠ å®‰å…¨é…ç½®æ³¨é‡Šï¼ˆå¼€å‘/ç”Ÿäº§åŒºåˆ†ï¼‰
    - ts_keystore.h æ›´æ–°å¤´æ–‡ä»¶æ–‡æ¡£å’Œå®‰å…¨åŸåˆ™è¯´æ˜

- **SSH å†…å­˜å¯†é’¥è®¤è¯ä¿®å¤**ï¼š
  - ä¿®å¤ libssh2 mbedTLS åç«¯ `gen_publickey_from_rsa()` ä¸­çš„ mpint padding bug
  - é—®é¢˜ï¼šæ£€æŸ¥ N çš„ MSB æ—¶ä½¿ç”¨ 1 å­—èŠ‚ buffer è°ƒç”¨ `mbedtls_mpi_write_binary()` å¯¼è‡´æœªå®šä¹‰è¡Œä¸º
  - è§£å†³ï¼šä½¿ç”¨ `mbedtls_mpi_bitlen()` æ­£ç¡®åˆ¤æ–­æ˜¯å¦éœ€è¦ padding
  - æ–‡ä»¶ï¼š`components/ch405labs_esp_libssh2/libssh2/src/mbedtls.c`
- **ts_keystore å®‰å…¨å¯†é’¥å­˜å‚¨å®Œå–„**ï¼š
  - å®ç° `--keyid` å‚æ•°æ”¯æŒä» NVS åŠ å¯†åˆ†åŒºåŠ è½½ç§é’¥
  - ç§é’¥æ°¸ä¸å†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œç›´æ¥åœ¨å†…å­˜ä¸­ä½¿ç”¨
  - å®Œæ•´å·¥ä½œæµï¼š`key --generate` â†’ `ssh --copyid --keyid` â†’ `ssh --keyid --shell`
- æ›´æ–° TROUBLESHOOTING.md æ–‡æ¡£ï¼ˆè®°å½• SSH mpint padding bugï¼‰
- æ›´æ–° COMMANDS.md æ–‡æ¡£ï¼ˆå®Œå–„ SSH/key å‘½ä»¤ç¤ºä¾‹ï¼‰

### 2026-01-15
- å®Œæˆé¡¹ç›®è§„åˆ’ä¸è®¾è®¡é˜¶æ®µ
- åˆ›å»ºæ¶æ„è®¾è®¡æ–‡æ¡£
- åˆ›å»ºå‘½ä»¤è§„èŒƒæ–‡æ¡£
- åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- ç¡®å®šæŠ€æœ¯é€‰å‹
- **Phase 1 å®Œæˆ**ï¼š
  - å®ç° ts_config æ¨¡å—ï¼ˆé…ç½®ç®¡ç†ï¼Œæ”¯æŒ NVS/æ–‡ä»¶åç«¯ï¼Œå˜æ›´é€šçŸ¥ï¼‰
  - å®ç° ts_log æ¨¡å—ï¼ˆå¤šçº§æ—¥å¿—ï¼Œæ§åˆ¶å°/æ–‡ä»¶/ç¼“å†²åŒºè¾“å‡ºï¼‰
  - å®ç° ts_event æ¨¡å—ï¼ˆå‘å¸ƒ/è®¢é˜…ï¼Œäº‹ä»¶ä¼˜å…ˆçº§ï¼Œäº‹åŠ¡æ”¯æŒï¼‰
- **Phase 2 å®Œæˆ**ï¼š
  - å®ç° ts_hal ä¸»æ¨¡å—ï¼ˆHALåˆå§‹åŒ–ã€å¹³å°æ£€æµ‹ã€èƒ½åŠ›æŸ¥è¯¢ï¼‰
  - å®ç° ts_pin_managerï¼ˆå¼•è„šåŠŸèƒ½æ˜ å°„ã€JSONé…ç½®åŠ è½½ã€NVSæŒä¹…åŒ–ï¼‰
  - å®ç° ts_hal_gpioï¼ˆGPIOæŠ½è±¡ã€æ–¹å‘/ä¸Šä¸‹æ‹‰é…ç½®ã€ISRæœåŠ¡ï¼‰
  - å®ç° ts_hal_pwmï¼ˆPWMæŠ½è±¡ã€LEDCé©±åŠ¨ã€å®šæ—¶å™¨è‡ªåŠ¨åˆ†é…ã€æ¸å˜æ§åˆ¶ï¼‰
  - å®ç° ts_hal_i2cï¼ˆI2CæŠ½è±¡ã€æ–°ç‰ˆi2c_master APIã€è®¾å¤‡æ‰«æï¼‰
  - å®ç° ts_hal_spiï¼ˆSPIæŠ½è±¡ã€æ€»çº¿/è®¾å¤‡åˆ†ç¦»ã€DMAæ”¯æŒï¼‰
  - å®ç° ts_hal_uartï¼ˆUARTæŠ½è±¡ã€äº‹ä»¶é˜Ÿåˆ—ã€å›è°ƒç³»ç»Ÿï¼‰
  - å®ç° ts_hal_adcï¼ˆADCæŠ½è±¡ã€oneshotæ¨¡å¼ã€æ›²çº¿/çº¿æ€§æ ¡å‡†ï¼‰
  - åˆ›å»º ESP32S3 å¹³å°é€‚é…å™¨ï¼ˆts_platform_s3ï¼‰
  - åˆ›å»º ESP32P4 å¹³å°é€‚é…å™¨å ä½ï¼ˆts_platform_p4ï¼‰
  - åˆ›å»º rm01_esp32s3 æ¿çº§é…ç½®ï¼ˆboard.jsonã€pins.jsonã€services.jsonï¼‰
  - å®ç° ts_service æ¨¡å—ï¼ˆ8é˜¶æ®µå¯åŠ¨ï¼Œä¾èµ–ç®¡ç†ï¼Œå¥åº·æ£€æŸ¥ï¼‰
  - åˆ›å»ºä¸»åº”ç”¨ç¨‹åºå…¥å£ï¼ˆmain.c, ts_core_init.cï¼‰
  - åˆ›å»ºé¡¹ç›®æ„å»ºé…ç½®ï¼ˆCMakeLists.txt, sdkconfig.defaults, partitions.csvï¼‰
- **Phase 3 å®Œæˆ**ï¼š
  - å®ç° ts_consoleï¼ˆesp_consoleé›†æˆ, argtable3å‚æ•°è§£æ, 9ä¸ªå†…ç½®å‘½ä»¤ï¼‰
  - å®ç° ts_api æ¡†æ¶ï¼ˆç«¯ç‚¹æ³¨å†Œ, JSONç»“æœ, æƒé™æ ‡è®°ï¼‰
  - å®ç° ts_api_systemï¼ˆsystem.info/memory/tasks/reboot/log.levelï¼‰
  - å®ç° ts_api_configï¼ˆconfig.get/set/delete/list/saveï¼‰
  - å®ç° ts_storageï¼ˆSPIFFSæŒ‚è½½/æ ¼å¼åŒ–, SDå¡SPI/SDIOæ¨¡å¼, æ–‡ä»¶æ“ä½œAPIï¼‰
- **Phase 4 å®Œæˆ**ï¼š
  - å®ç° ts_led æ ¸å¿ƒï¼ˆè®¾å¤‡ç®¡ç†, æ¸²æŸ“ä»»åŠ¡, äº®åº¦æ§åˆ¶ï¼‰
  - å®ç° ts_led_driverï¼ˆWS2812 RMTé©±åŠ¨, led_stripé›†æˆï¼‰
  - å®ç° ts_led_layerï¼ˆå›¾å±‚ç³»ç»Ÿ, ç»˜å›¾æ“ä½œ: åƒç´ /å¡«å……/çŸ©å½¢/çº¿/åœ†/æ¸å˜ï¼‰
  - å®ç° ts_led_colorï¼ˆHSV/RGBè½¬æ¢, è°ƒè‰²ç›˜, é¢œè‰²æ··åˆ, é¢œè‰²è§£æï¼‰
  - å®ç° ts_led_effectsï¼ˆ6ç§å†…ç½®ç‰¹æ•ˆ: rainbow/breathing/chase/fire/sparkle/solidï¼‰
  - å®ç° ts_led_imageï¼ˆBMPå›¾åƒåŠ è½½, å›¾åƒæ˜¾ç¤ºï¼‰
  - å®ç° ts_led_presetï¼ˆtouch/board/matrixè®¾å¤‡é¢„è®¾, çŠ¶æ€æŒ‡ç¤ºå™¨ï¼‰
- **Phase 5 å®Œæˆ**ï¼š
  - å®ç° ts_drivers ä¸»æ¨¡å—ï¼ˆåˆå§‹åŒ–/ååˆå§‹åŒ–ï¼‰
  - å®ç° ts_fanï¼ˆPWMé£æ‰‡æ§åˆ¶, æ¸©åº¦æ›²çº¿, Tachè½¬é€Ÿæµ‹é‡ï¼‰
  - å®ç° ts_powerï¼ˆADCç”µå‹ç›‘æµ‹, ç”µå‹è­¦æŠ¥ï¼‰
  - å®ç° ts_device_ctrlï¼ˆAGXç”µæºæ§åˆ¶, å…³æœºè¯·æ±‚å¤„ç†ï¼‰
  - å®ç° ts_usb_muxï¼ˆUSBåˆ‡æ¢æ§åˆ¶, Host/Deviceæ¨¡å¼ï¼‰
- **Phase 6 å®Œæˆ**ï¼š
  - å®ç° ts_net ç½‘ç»œæ¡†æ¶ï¼ˆçŠ¶æ€æŸ¥è¯¢, IPé…ç½®, MAC/ä¸»æœºåï¼‰
  - å®ç° ts_ethï¼ˆW5500 SPIä»¥å¤ªç½‘, äº‹ä»¶å¤„ç†ï¼‰
  - å®ç° ts_wifiï¼ˆSTA/AP/APSTAæ¨¡å¼, æ‰«æ, è¿æ¥ç®¡ç†ï¼‰
  - å®ç° ts_dhcp_serverï¼ˆlwIP DHCPæœåŠ¡å™¨å°è£…ï¼‰
  - å®ç° ts_http_serverï¼ˆè·¯ç”±æ³¨å†Œ, è¯·æ±‚å¤„ç†, æ–‡ä»¶æœåŠ¡, CORSï¼‰
  - å®ç° ts_securityï¼ˆä¼šè¯ç®¡ç†, æƒé™æ£€æŸ¥, Tokenè®¤è¯ï¼‰
  - å®ç° ts_cryptoï¼ˆSHAå“ˆå¸Œ, HMAC, AES-GCM, Base64/Hexï¼‰
  - å®ç° ts_authï¼ˆç™»å½•/ç™»å‡º, å¯†ç éªŒè¯ï¼‰
  - å®ç° ts_ssh_clientï¼ˆSSH-2.0åè®®, å¯†ç /å…¬é’¥è®¤è¯, è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼‰
  - å®ç° ts_ssh_known_hostsï¼ˆä¸»æœºå¯†é’¥éªŒè¯, SHA256æŒ‡çº¹, TOFUç­–ç•¥, NVSå­˜å‚¨ï¼‰
  - å®ç° ts_port_forwardï¼ˆæœ¬åœ°ç«¯å£è½¬å‘, å¤šå¹¶å‘è¿æ¥, libssh2éš§é“ï¼‰
  - å®ç° ts_ssh_shellï¼ˆPTYåˆ†é…, å¤šç»ˆç«¯ç±»å‹, åŒå‘I/O, ä¿¡å·å¤„ç†ï¼‰
  - å®ç° SSH å¯†é’¥ç”Ÿæˆï¼ˆRSA/ECDSAç”Ÿæˆ, PEMç§é’¥å¯¼å‡º, OpenSSHå…¬é’¥æ ¼å¼ï¼‰
- **Phase 7 å®Œæˆ**ï¼š
  - å®ç° ts_webui ä¸»æ¨¡å—ï¼ˆåˆå§‹åŒ–/å¯åŠ¨/åœæ­¢ï¼‰
  - å®ç° ts_webui_apiï¼ˆREST APIç½‘å…³, ç™»å½•/ç™»å‡º, Tokenè®¤è¯ï¼‰
  - å®ç° ts_webui_wsï¼ˆWebSocketå¹¿æ’­, äº‹ä»¶æ¨é€ï¼‰
  - åˆ›å»ºå‰ç«¯ç•Œé¢ï¼ˆindex.htmlä»ªè¡¨ç›˜, CSSæ ·å¼, APIå®¢æˆ·ç«¯, WSå®¢æˆ·ç«¯ï¼‰
- **Phase 8 å®Œæˆ**ï¼š
  - åˆ›å»ºå¿«é€Ÿå…¥é—¨æŒ‡å— (docs/QUICK_START.md)
  - åˆ›å»º API å‚è€ƒæ–‡æ¡£ (docs/API_REFERENCE.md)
  - åˆ›å»ºæ¿çº§é…ç½®æŒ‡å— (docs/BOARD_CONFIGURATION.md)
  - æ›´æ–° README.md
  - æ›´æ–°å¼€å‘è¿›åº¦æ–‡æ¡£

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ¶æ„è®¾è®¡æ–‡æ¡£](docs/ARCHITECTURE_DESIGN.md)
- [å‘½ä»¤è§„èŒƒæ–‡æ¡£](docs/COMMAND_SPECIFICATION.md)
- [åŸé¡¹ç›®æè¿°](PROJECT_DESCRIPTION.md)
- [é‡æ„åˆ†æ](REFACTORING_ANALYSIS.md)
