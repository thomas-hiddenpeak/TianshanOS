# TianShanOS å¿«é€Ÿå…¥é—¨æŒ‡å—

## ç®€ä»‹

TianShanOS æ˜¯ä¸€ä¸ªé¢å‘ ESP32 çš„é…ç½®é©±åŠ¨åµŒå…¥å¼æ“ä½œç³»ç»Ÿï¼Œä¸“ä¸º NVIDIA Jetson AGX è½½æ¿è®¾è®¡ã€‚

## ç³»ç»Ÿè¦æ±‚

- ESP-IDF v5.5.1 æˆ–æ›´é«˜ç‰ˆæœ¬
- ESP32S3ï¼ˆä¸»è¦æ”¯æŒï¼‰æˆ– ESP32P4
- Python 3.8+
- Git

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£… ESP-IDF
mkdir -p ~/esp
cd ~/esp
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf
git checkout v5.5.1
./install.sh esp32s3
source export.sh
```

### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/your-repo/TianshanOS.git
cd TianshanOS
```

### 3. é…ç½®é¡¹ç›®

```bash
# è®¾ç½®ç›®æ ‡èŠ¯ç‰‡
idf.py set-target esp32s3

# æ‰“å¼€é…ç½®èœå•
idf.py menuconfig
```

å…³é”®é…ç½®é¡¹ï¼š
- `TianShanOS Configuration` â†’ å„æ¨¡å—å¯ç”¨/é…ç½®
- `Serial flasher config` â†’ ä¸²å£è®¾ç½®
- `Partition Table` â†’ ä½¿ç”¨è‡ªå®šä¹‰åˆ†åŒºè¡¨

### 4. ç¼–è¯‘å›ºä»¶

```bash
idf.py build
```

### 5. çƒ§å½•å›ºä»¶

```bash
idf.py -p /dev/ttyUSB0 flash
```

### 6. ç›‘æ§è¾“å‡º

```bash
idf.py -p /dev/ttyUSB0 monitor
```

## æ§åˆ¶å°å‘½ä»¤

ç³»ç»Ÿå¯åŠ¨åï¼Œå¯é€šè¿‡ä¸²å£æ§åˆ¶å°ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š

```
help              - æ˜¾ç¤ºå¸®åŠ©
version           - æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯
sysinfo           - æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯
tasks             - æ˜¾ç¤ºä»»åŠ¡åˆ—è¡¨
free              - æ˜¾ç¤ºå†…å­˜ä½¿ç”¨
reboot            - é‡å¯ç³»ç»Ÿ
log <level>       - è®¾ç½®æ—¥å¿—çº§åˆ«
```

## Web ç•Œé¢

1. è¿æ¥åˆ°è®¾å¤‡ç½‘ç»œï¼ˆä»¥å¤ªç½‘æˆ– WiFi APï¼‰
2. æ‰“å¼€æµè§ˆå™¨è®¿é—®è®¾å¤‡ IP åœ°å€
3. é»˜è®¤ç™»å½•å‡­æ®ï¼š
   - ç”¨æˆ·å: `admin`
   - å¯†ç : `tianshan`

### WebUI é¡µé¢å¯¼èˆª

- **ç³»ç»Ÿ**ï¼šæ¦‚è§ˆã€èµ„æºç›‘æ§ã€æœåŠ¡ç®¡ç†
- **ç½‘ç»œ**ï¼šç½‘ç»œçŠ¶æ€ã€IP é…ç½®ã€è¿æ¥ç®¡ç†
- **ç›‘æ§**ï¼šAGX/LPMU è®¾å¤‡ç›‘æ§
- **æ–‡ä»¶**ï¼šSD å¡/SPIFFS æ–‡ä»¶ç®¡ç†
- **ç»ˆç«¯**ï¼šCLI å‘½ä»¤è¡Œ + SSH Shellï¼ˆç‚¹å‡»æ ‡é¢˜æ  "ğŸ“‹ ç³»ç»Ÿæ—¥å¿—" æŸ¥çœ‹å®æ—¶æ—¥å¿—ï¼‰
- **é…ç½®**ï¼šNVS é”®å€¼å¯¹ç®¡ç†
- **å®‰å…¨**ï¼šSSH å¯†é’¥ã€è¯ä¹¦ç®¡ç†

### æ—¥å¿—æŸ¥çœ‹

ç³»ç»Ÿæ—¥å¿—å·²æ•´åˆåˆ°**ç»ˆç«¯é¡µé¢**ï¼š
1. è®¿é—® `#/terminal` é¡µé¢
2. ç‚¹å‡»æ ‡é¢˜æ å³ä¾§çš„ **"ğŸ“‹ ç³»ç»Ÿæ—¥å¿—"** æŒ‰é’®
3. æ¨¡æ€æ¡†æä¾›å®Œæ•´çš„æ—¥å¿—è°ƒè¯•åŠŸèƒ½ï¼š
   - å†å²æ—¥å¿—åŠ è½½ï¼ˆæœ€è¿‘ 500 æ¡ï¼‰
   - å®æ—¶æ—¥å¿—æµï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰
   - çº§åˆ«è¿‡æ»¤ï¼ˆERROR/WARN/INFO/DEBUG/VERBOSEï¼‰
   - TAG è¿‡æ»¤ã€å…³é”®è¯æœç´¢
   - æ¸…ç©ºã€åˆ·æ–°ã€è‡ªåŠ¨æ»šåŠ¨

### å›ºä»¶å‡çº§ (OTA)

1. åœ¨**ç³»ç»Ÿé¡µé¢**æ‰¾åˆ°"å›ºä»¶ç®¡ç†"å¡ç‰‡
2. ç‚¹å‡»"ğŸ”„ å›ºä»¶å‡çº§ (OTA)"æŒ‰é’®
3. ä¸Šä¼ æ–°å›ºä»¶ (.bin) å¹¶é‡å¯è®¾å¤‡

> **æ³¨æ„**ï¼šOTA åŠŸèƒ½ä¹Ÿå¯é€šè¿‡ç›´æ¥è®¿é—® `http://<device-ip>/#/ota` ä½¿ç”¨

## é…ç½®æ–‡ä»¶

### æ¿çº§é…ç½®

é…ç½®æ–‡ä»¶ä½äº `boards/<board_name>/`:

- `board.json` - æ¿çº§ç‰¹æ€§å®šä¹‰
- `pins.json` - å¼•è„šæ˜ å°„
- `services.json` - æœåŠ¡é…ç½®

### è¿è¡Œæ—¶é…ç½®

è¿è¡Œæ—¶é…ç½®å­˜å‚¨åœ¨ NVS ä¸­ï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ï¼š

1. æ§åˆ¶å°å‘½ä»¤
2. Web ç•Œé¢
3. API è°ƒç”¨

## API ä½¿ç”¨

### REST API

```bash
# è·å–ç³»ç»Ÿä¿¡æ¯
curl http://<device-ip>/api/v1/system/info

# ç™»å½•è·å– Token
curl -X POST http://<device-ip>/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"tianshan"}'

# ä½¿ç”¨ Token è°ƒç”¨ API
curl http://<device-ip>/api/v1/config/list \
  -H "Authorization: Bearer <token>"
```

## å¸¸è§é—®é¢˜

### Q: çƒ§å½•å¤±è´¥
A: æ£€æŸ¥ä¸²å£æƒé™ï¼Œç¡®ä¿æŒ‰ä½ BOOT æŒ‰é’®å†æŒ‰ RESET

### Q: æ— æ³•è¿æ¥ WiFi
A: æ£€æŸ¥ SSID å’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿ WiFi æ¨¡å—å·²å¯ç”¨

### Q: LED ä¸äº®
A: æ£€æŸ¥ pins.json ä¸­çš„å¼•è„šé…ç½®ï¼Œç¡®ä¿ä¸ç¡¬ä»¶åŒ¹é…

## ä¸‹ä¸€æ­¥

- é˜…è¯» [æ¶æ„è®¾è®¡æ–‡æ¡£](ARCHITECTURE_DESIGN.md)
- æŸ¥çœ‹ [å‘½ä»¤è§„èŒƒæ–‡æ¡£](COMMAND_SPECIFICATION.md)
- æ¢ç´¢ [API å‚è€ƒ](API_REFERENCE.md)
